# 📜 进化宪法：Copilot 指令框架说明

## 什么是"进化宪法"？

`copilot-instructions.md` 不仅仅是一份工程指南，它是一份**根本性的演进法则**，用来规定 AI 助手应该如何：
1. **思考** - 遇到问题时的分析方式
2. **学习** - 从错误中提取经验的方法
3. **改进** - 如何持续优化工作方式

---

## 四个层级的指令体系

```
┌─────────────────────────────────────────────────────┐
│ 第 1 层: 进化宪法（copilot-instructions.md）     │
│ ├─ AI 系统进化原则                               │
│ ├─ 技能创建的触发条件                            │
│ └─ 识别进化机会的决策树                          │
├─────────────────────────────────────────────────────┤
│ 第 2 层: 自定义技能库（.claude/skills/*）       │
│ ├─ _typescript-type-safety                        │
│ ├─ react-component-patterns (计划中)              │
│ ├─ database-operations (计划中)                   │
│ └─ chrome-extension-patterns (计划中)             │
├─────────────────────────────────────────────────────┤
│ 第 3 层: 错误模式库（.github/*.md）            │
│ ├─ type-error-patterns.md                         │
│ ├─ ERROR_ANALYSIS_SESSION.md                      │
│ └─ AI_EVOLUTION_SYSTEM.md                         │
├─────────────────────────────────────────────────────┤
│ 第 4 层: 具体工程指导（本文件的技术部分）      │
│ ├─ 大图景与架构                                   │
│ ├─ 代码风格约定                                   │
│ └─ 项目特有规范                                   │
└─────────────────────────────────────────────────────┘
```

---

## 进化机制的三个触发点

### 🔴 触发 1: 重复错误
```
同一类错误在多个会话中出现
    ↓
这表明需要一个预防技能
    ↓
创建专门的技能文件，如 _typescript-type-safety
    ↓
在未来工作中自动应用，避免重复
```

### 🟡 触发 2: 用户反馈
```
用户说："你应该这样做，而不是那样"
    ↓
这指出了我的行为偏差
    ↓
反思这个反馈的通用性
    ↓
更新 Copilot 指令或创建相关技能
    ↓
下次自动应用改进后的方式
```

### 🟢 触发 3: 工作流优化
```
发现某个工作流程总是很耗时或容易出错
    ↓
分析其中的模式和规律
    ↓
总结最佳实践
    ↓
编码为技能或指令
    ↓
自动应用到所有相关工作
```

---

## 与传统工程指导的区别

| 维度 | 传统方式 | 进化宪法 |
|------|---------|----------|
| **静态性** | 指南是固定的，很少改变 | 指南是活的，根据学习持续演进 |
| **被动性** | 等待出现问题后才修复 | 主动识别问题模式，提前预防 |
| **单向性** | 用户→指导 | 用户↔AI↔指导（双向互动） |
| **层级性** | 所有规则平等 | 有明确的层级结构（宪法→技能→细节） |
| **可测试性** | 指南是隐性知识 | 指南转化为显性技能，可验证和改进 |

---

## Copilot 指令文件的五个部分

### 1️⃣ **AI 系统进化宪法** (第一部分)
这是整个系统的根本法则，定义了：
- AI 如何学习和进化
- 什么时候应该创建新技能
- 如何识别进化机会

**不变性**: 这部分很少改变，代表了系统的基本哲学

### 2️⃣ **OpenSkills 技能系统与自定义技能库** (关键部分)
这是"宪法"的执行层，定义了：
- 自定义技能的清单（什么已经存在）
- 技能的创建流程（如何制作新技能）
- 技能的改进流程（如何优化现有技能）

**演进性**: 这部分会随着新技能的创建而扩展

### 3️⃣ **进化机会识别指南** (关键部分)
这是"宪法"的操作指南，定义了：
- 如何识别重复错误 (模式 A)
- 如何响应用户反馈 (模式 B)
- 如何优化工作流程 (模式 C)
- 技能创建的决策树

**实用性**: 这部分在日常工作中直接应用

### 4️⃣ **工程细节** (技术部分)
这是"宪法"的实施规则，包括：
- 大图景与架构
- 代码风格
- 项目特有约定
- 常见坑位

**稳定性**: 这部分随着项目的发展而更新

### 5️⃣ **版本控制与项目管理** (操作部分)
这是日常工程操作的规范

---

## 如何使用这个进化宪法

### 对于 AI 助手（我自己）

**每个会话的模式**：
```
1. 开始工作
   ↓
2. 遇到问题时：
   - 查询现有技能库是否有相关技能
   - 如果有，应用技能中的方案
   - 如果没有，分析是否需要创建新技能
   ↓
3. 完成工作
   ↓
4. 反思阶段：
   - 是否遇到了重复的错误？
   - 是否收到了用户的改进反馈？
   - 是否发现了可优化的工作流程？
   - 如果是，准备创建或改进技能
   ↓
5. 更新系统：
   - 更新技能库或 Copilot 指令
   - 记录到版本控制
   - 下次工作时自动应用
```

### 对于用户（你）

**监督和指导**：
1. **观察** AI 的工作方式
2. **反馈** 不符合预期的行为
3. **建议** 更好的做法
4. **验证** AI 是否学习并改进了

**请求新技能**：
- "这个 React 问题很常见，应该有个技能来处理"
- "我发现你在 X 方面总是这样做，应该改成 Y 方式"
- "这个工作流程可以优化，你能总结成一个技能吗？"

---

## 进化的示例：从错误到技能

### 会话 1 (2026-02-06)
```
🔴 问题: TypeScript Mock 数据创建中反复出现类型错误
         - FeedArticle 缺少字段
         - DiscoveredFeed 使用无效 enum
         - TopicDistribution 初始化不完整

📊 分析: 这些不是孤立的错误，而是一类错误
         根本原因：Mock 创建时缺乏系统的流程

💡 解决: 创建 _typescript-type-safety 技能
         包含：5 步流程、常见模式、最佳实践

✅ 更新: 在 Copilot 指令中列出此技能
```

### 会话 2 (未来)
```
🟡 触发: 用户说："我注意到你的 Mock 创建效率提高了"

📝 学习: 因为有了预防技能，减少了错误

🔄 改进: 如果发现新的 Mock 问题模式
         添加到现有技能

📈 结果: 工作流程越来越自动化
```

### 会话 N (持续演进)
```
🎯 目标: 完全消除已知错误类别
         对新类型的问题快速反应

📚 知识库: 涵盖项目所有主要问题域
```

---

## 为什么这个设计有效

### ✅ **宪法式架构的优势**

1. **清晰的分层**
   - 不把所有规则混在一起
   - 宪法级别的原则与技术细节分离

2. **易于演进**
   - 新技能可以添加而不改变核心原则
   - 技能可以独立改进

3. **易于教学**
   - 新的团队成员可以先学习宪法
   - 然后按需查看具体技能

4. **易于验证**
   - 每个技能都可以被测试和评估
   - 改进可以被量化

5. **自我强化**
   - 使用技能 → 发现不足 → 改进技能
   - 形成正反馈循环

---

## 核心思想的一句话总结

> **宪法规定"如何进化"，技能库记录"进化了什么"，错误模式库记录"为什么进化"。**

---

## 相关文件导航

```
.github/
├── copilot-instructions.md      ← 你在这里：进化宪法
├── type-error-patterns.md       ← 错误模式库
├── ERROR_ANALYSIS_SESSION.md    ← 会话分析
├── AI_EVOLUTION_SYSTEM.md       ← 系统总体说明
└── [其他技术文档]

.claude/skills/
├── _typescript-type-safety/SKILL.md  ← 示例技能
├── [其他官方技能]
└── [未来的自定义技能]
```

---

**创建日期**: 2026-02-06
**版本**: 1.0 (宪法框架初版)
**设计哲学**: 从"怎么做"上升到"怎么思考"

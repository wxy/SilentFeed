# Phase 15: é˜…è¯»æ¸…å•æ¨¡å¼ - åç»­å®ç°æ­¥éª¤

## çŠ¶æ€æ¦‚è§ˆ

### âœ… å·²å®Œæˆ
1. **æŠ•é€’æ–¹å¼é…ç½® UI**
   - åœ¨ RecommendationSettings ä¸­æ·»åŠ æŠ•é€’æ–¹å¼é€‰æ‹©ï¼ˆå¼¹çª— vs é˜…è¯»æ¸…å•ï¼‰
   - é˜…è¯»æ¸…å•æ ‡é¢˜å‰ç¼€é…ç½®
   - å®Œæ•´çš„æ¸…ç†é…ç½®ï¼ˆå¯ç”¨ã€ä¿ç•™å¤©æ•°ã€æ¡ç›®æ•°ã€é—´éš”ã€æœªè¯»ä¿ç•™ï¼‰
   - æ‰‹åŠ¨æ¸…ç†åŠŸèƒ½

2. **é…ç½®å­˜å‚¨**
   - æ‰€æœ‰é…ç½®ä¿å­˜åˆ° `recommendationConfig`ï¼ˆåŒæ­¥è®¾ç½®ï¼‰
   - éµå¾ªæ­£ç¡®çš„æ¶æ„ï¼šsync = è®¾ç½®ï¼Œlocal = ä¸´æ—¶å€¼

3. **ç³»ç»Ÿæ¶æ„**
   - AIConfigï¼šAI æ¨¡å‹ã€æä¾›å•†ã€API å¯†é’¥ã€æœ¬åœ° AIã€æˆæœ¬
   - RecommendationSettingsï¼šæŠ•é€’æ–¹å¼ã€é˜…è¯»æ¸…å•é…ç½®ã€æ¨èç­–ç•¥æ˜¾ç¤º
   - maxRecommendationsï¼šç³»ç»Ÿè‡ªåŠ¨ç®¡ç†ï¼ˆæ— éœ€ç”¨æˆ·å¹²é¢„ï¼‰

---

## â³ å¾…å®ç° - å…³é”®åŠŸèƒ½

### 1. é˜…è¯»æ¸…å•æ¨¡å¼ä¸‹çš„å¼¹çª—æ˜¾ç¤ºé€»è¾‘
**å½“ç”¨æˆ·é€‰æ‹©"é˜…è¯»æ¸…å•"æŠ•é€’æ–¹å¼æ—¶ï¼Œå¼¹çª—åº”è¯¥æ˜¾ç¤ºæ±‡æ€»ä¿¡æ¯è€Œéæ¨èæ¡ç›®**

#### å½“å‰çŠ¶æ€
- popup.tsx ç›®å‰æ€»æ˜¯æ˜¾ç¤º RecommendationViewï¼ˆæ¨èæ¡ç›®åˆ—è¡¨ï¼‰
- æ²¡æœ‰æ£€æŸ¥ deliveryMode é…ç½®

#### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶
1. **src/popup.tsx**
   - åŠ è½½ recommendationConfig è·å– deliveryMode
   - æ ¹æ® deliveryMode å†³å®šæ˜¾ç¤ºå†…å®¹
   - å½“ deliveryMode === 'readingList' æ—¶ï¼Œæ˜¾ç¤ºé˜…è¯»æ¸…å•æ±‡æ€»ç»„ä»¶

2. **æ–°å»º src/components/ReadingListSummaryView.tsx**
   - æ˜¾ç¤ºé˜…è¯»æ¸…å•çš„ç»Ÿè®¡ä¿¡æ¯
   - æ˜¾ç¤ºæœ€è¿‘æ·»åŠ çš„æ¡ç›®æ‘˜è¦
   - æ˜¾ç¤ºæ¸…ç†çŠ¶æ€
   - å¿«é€Ÿæ‰“å¼€é˜…è¯»æ¸…å•çš„é“¾æ¥ï¼ˆä½¿ç”¨ Reading List APIï¼‰

#### UI è®¾è®¡å‚è€ƒ
é˜…è¯»æ¸…å•æ¨¡å¼ä¸‹å¼¹çª—åº”æ˜¾ç¤ºï¼š
- ğŸ“Š é˜…è¯»æ¸…å•ç»Ÿè®¡ï¼ˆæ€»æ•°ã€æœªè¯»æ•°ã€æ–°å¢æ•°ï¼‰
- ğŸ†• æœ€è¿‘æ·»åŠ çš„æ¡ç›®ï¼ˆ3-5 æ¡ï¼‰
- ğŸ§¹ æ¸…ç†çŠ¶æ€å’Œä¸‹æ¬¡æ¸…ç†æ—¶é—´
- ğŸ”— å¿«é€Ÿæ‰“å¼€æŒ‰é’®ï¼ˆæ‰“å¼€ Chrome Reading List é¡µé¢æˆ–æœ¬åœ°æ¸…å•é¡µé¢ï¼‰

#### å®ç°æ­¥éª¤
1. [ ] åœ¨ popup.tsx ä¸­åŠ è½½ getRecommendationConfig
2. [ ] åˆ›å»ºæ¡ä»¶æ¸²æŸ“é€»è¾‘ï¼šdeliveryMode æ£€æŸ¥
3. [ ] åˆ›å»º ReadingListSummaryView ç»„ä»¶
   - [ ] ä»æ•°æ®åº“æŸ¥è¯¢é˜…è¯»æ¸…å•ç»Ÿè®¡ä¿¡æ¯
   - [ ] æ˜¾ç¤ºæœ€è¿‘æ·»åŠ çš„æ¡ç›®
   - [ ] æ˜¾ç¤ºæ¸…ç†è®¡åˆ’
4. [ ] æ·»åŠ å¿«é€Ÿæ“ä½œæŒ‰é’®
5. [ ] æ ·å¼é€‚é…ï¼ˆä¸æ¨èè§†å›¾ä¿æŒä¸€è‡´ï¼‰

---

## æŠ€æœ¯ç»†èŠ‚

### è¯»å– Reading List æ•°æ®
- è¡¨åï¼š`readingListEntries` (Dexie)
- å­—æ®µï¼š
  ```typescript
  id: string
  url: string
  title: string
  description?: string
  addedAt: number
  status: 'unread' | 'read'
  source: 'popup' | 'manual'
  ```

### ç»Ÿè®¡æŸ¥è¯¢
```typescript
// æ€»æ•°
const totalCount = await db.readingListEntries.count()

// æœªè¯»æ•°
const unreadCount = await db.readingListEntries.where('status').equals('unread').count()

// æœ€è¿‘ 24 å°æ—¶æ·»åŠ 
const recentCount = await db.readingListEntries
  .where('addedAt').above(Date.now() - 24*3600*1000)
  .count()

// æœ€è¿‘ 5 æ¡æ¡ç›®
const recent = await db.readingListEntries
  .orderBy('addedAt')
  .reverse()
  .limit(5)
  .toArray()
```

### æ¸…ç†çŠ¶æ€æ£€æŸ¥
- ä» recommendationConfig è·å– cleanup é…ç½®
- è®¡ç®—ä¸‹æ¬¡æ¸…ç†æ—¶é—´ = æœ€åæ¸…ç†æ—¶é—´ + intervalHours
- æ˜¾ç¤ºè¿›åº¦æˆ–å€’è®¡æ—¶

---

## å…³é”®è€ƒè™‘

1. **ä¸ä¸æ¨èç³»ç»Ÿå†²çª**
   - é˜…è¯»æ¸…å•æ¨¡å¼ä¸åº”è¯¥è§¦å‘æ¨èæ¡ç›®ç”Ÿæˆ
   - åå°åº”è¯¥æ£€æŸ¥ deliveryModeï¼Œå¦‚æœæ˜¯ readingList åˆ™åœç”¨æ¨èç”Ÿæˆï¼ˆæˆ–æ”¹ä¸ºæ·»åŠ åˆ°æ¸…å•ï¼‰

2. **ç”¨æˆ·ä½“éªŒ**
   - å¼¹çª—åˆ‡æ¢æŠ•é€’æ–¹å¼æ—¶åº”ç«‹å³ç”Ÿæ•ˆï¼ˆæ— éœ€åˆ·æ–°ï¼‰
   - æ¸…å•æ±‡æ€»ä¿¡æ¯åº”å®æ—¶æ›´æ–°
   - æ¸…ç†æ“ä½œåº”æœ‰è§†è§‰åé¦ˆ

3. **æ•°æ®åŒæ­¥**
   - Chrome Reading List API å’Œæœ¬åœ° Dexie æ•°æ®åº“çš„åŒæ­¥
   - æ‰‹åŠ¨æ¸…ç†åç«‹å³æ›´æ–°ç»Ÿè®¡ä¿¡æ¯

---

## ç›¸å…³ä»£ç ä½ç½®

- æŠ•é€’æ–¹å¼é…ç½®ï¼š`src/components/settings/RecommendationSettings.tsx`ï¼ˆå·²å®Œæˆï¼‰
- æ¨èæ¨¡å¼å¼¹çª—ï¼š`src/components/RecommendationView.tsx`
- æ•°æ®åº“å®šä¹‰ï¼š`src/storage/db/db-reading-list.ts`
- åå°æ¶ˆæ¯å¤„ç†ï¼š`src/background.ts`

---

## ä¼˜å…ˆçº§ï¼šğŸ”´ é«˜

è¿™æ˜¯é˜…è¯»æ¸…å•æ¨¡å¼åŠŸèƒ½å®Œæ•´æ€§çš„å…³é”®ï¼Œéœ€è¦åœ¨ä¸‹ä¸€ä¸ª sprint å®Œæˆã€‚

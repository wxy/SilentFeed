# æ¨èç³»ç»Ÿæ¶æ„é‡æ–°è®¾è®¡

> **ä»å›ºå®šç­–ç•¥åˆ° AI é©±åŠ¨çš„åŠ¨æ€æ¨èç³»ç»Ÿ**
> 
> ç‰ˆæœ¬: v2.0  
> åˆ›å»ºæ—¶é—´: 2026å¹´1æœˆ2æ—¥

---

## ğŸ“‹ ç›®å½•

1. [é—®é¢˜è¯Šæ–­](#é—®é¢˜è¯Šæ–­)
2. [æ¶æ„é‡è®¾è®¡](#æ¶æ„é‡è®¾è®¡)
3. [å¤šæ± æ¶æ„](#å¤šæ± æ¶æ„)
4. [AI ç­–ç•¥å†³ç­–](#ai-ç­–ç•¥å†³ç­–)
5. [å®æ–½æ–¹æ¡ˆ](#å®æ–½æ–¹æ¡ˆ)

---

## é—®é¢˜è¯Šæ–­

### å½“å‰æ¶æ„çš„æ ¸å¿ƒçŸ›ç›¾

```
ä¾›ç»™ä¾§ï¼ˆä¸å¯æ§ï¼‰ï¼šè®¢é˜…æºä»¥è‡ªå·±çš„èŠ‚å¥ç”Ÿäº§æ–‡ç« 
   â†•ï¸  ä¸åŒ¹é…
è°ƒåº¦ä¾§ï¼ˆåƒµåŒ–ï¼‰ï¼šå›ºå®šç­–ç•¥ï¼ˆrefill cooldownã€å›ºå®šé˜ˆå€¼ï¼‰
   â†•ï¸  ä¸åŒ¹é…
éœ€æ±‚ä¾§ï¼ˆä¸å¯æ§ï¼‰ï¼šç”¨æˆ·ä»¥è‡ªå·±çš„èŠ‚å¥æ¶ˆè´¹æ¨è
```

### å…·ä½“é—®é¢˜

1. **æ¨èè¿‡è½½**ï¼šé«˜äº§æº + æ…¢æ¶ˆè´¹ç”¨æˆ· = æ¨èå †ç§¯ï¼Œä½åˆ†æ–‡ç« å……æ•°
2. **æ¨èä¸è¶³**ï¼šä½äº§æº + å¿«æ¶ˆè´¹ç”¨æˆ· = æ— å†…å®¹å¯æ¨è
3. **ç­–ç•¥åƒµåŒ–**ï¼šåŸºäºè§„åˆ™çš„ç­–ç•¥è¦ä¹ˆå¤ªå¤æ‚ï¼Œè¦ä¹ˆå¤ªæœºæ¢°
4. **å†·å†»æœºåˆ¶ä¸åŒ¹é…**ï¼šå›ºå®šçš„ refill cooldown æ— æ³•é€‚åº”åŠ¨æ€åœºæ™¯

### æ ¹æœ¬åŸå› 

**è¯•å›¾ç”¨å›ºå®šç­–ç•¥åŒ¹é…ä¸¤ä¸ªåŠ¨æ€çš„ã€ä¸å¯æ§çš„å˜é‡**

---

## æ¶æ„é‡è®¾è®¡

### è®¾è®¡ç†å¿µ

**ä»"åŸºäºè§„åˆ™"åˆ°"AI é©±åŠ¨"**ï¼š
- ä¸å†é¢„è®¾å›ºå®šè§„åˆ™
- å°†æ‰€æœ‰è€ƒè™‘å› ç´ æ¸…æ™°åœ°å‘ŠçŸ¥ AI
- è®© AI åŸºäºå®æ—¶æ•°æ®ç»™å‡ºå‚æ•°åŒ–ç­–ç•¥
- ç¨‹åºæ ¹æ®ç­–ç•¥åŠ¨æ€è°ƒæ•´è¡Œä¸º

### æ ¸å¿ƒåŸåˆ™

1. **é€æ˜çš„æ•°æ®æµ**ï¼šæ–‡ç« åœ¨å„ä¸ªæ± å­é—´çš„æµè½¬æ¸…æ™°å¯è¿½æº¯
2. **åŠ¨æ€çš„ç­–ç•¥**ï¼šæ ¹æ®å®æ—¶ä¾›éœ€æƒ…å†µè°ƒæ•´æ¨èè¡Œä¸º
3. **æ™ºèƒ½çš„é—¨æ§**ï¼šAI å†³å®šä½•æ—¶åˆ†æã€ä½•æ—¶æ¨èã€ä½•æ—¶å†·å†»
4. **ç”¨æˆ·ä¸ºä¸­å¿ƒ**ï¼šä»¥ç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ä¸ºé”šç‚¹ï¼Œåå‘è°ƒæ•´ä¾›ç»™

---

## å¤šæ± æ¶æ„

### æ–‡ç« ç”Ÿå‘½å‘¨æœŸï¼š4 ä¸ªæ± å­

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è®¢é˜…æºè‡ªåŠ¨æ›´æ–°ï¼ˆç‹¬ç«‹æœºåˆ¶ï¼‰                    â”‚
â”‚                             â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Pool 1: åŸå§‹æ±  (Raw Pool)                              â”‚   â”‚
â”‚  â”‚ - çŠ¶æ€: analysis=nullï¼ˆæœªåˆ†æï¼‰                         â”‚   â”‚
â”‚  â”‚ - èŒƒå›´: æ‰€æœ‰æœªåˆ†æçš„æ–‡ç« ï¼ˆåŒ…æ‹¬ inFeed=falseï¼‰             â”‚   â”‚
â”‚  â”‚ - ç›®çš„: é¿å…å› åˆ†æä¸åŠæ—¶è€Œä¸¢å¤±è¢«æºå‰”é™¤çš„æ–‡ç«               â”‚   â”‚
â”‚  â”‚ - å®¹é‡: æ— ä¸Šé™ï¼ˆè‡ªåŠ¨ç»´æŠ¤åˆ é™¤ä¹…è¿œæ–‡ç« ï¼‰                     â”‚   â”‚
â”‚  â”‚ - æµå‡º: AI åˆ†æåæµå‘ Pool 2 æˆ– Pool 3                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â†“                                 â”‚
â”‚                      AI æ–‡ç« åˆ†æä»»åŠ¡                           â”‚
â”‚                    ï¼ˆåŠ¨æ€è°ƒåº¦é¢‘ç‡ï¼‰                             â”‚
â”‚                             â†“                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚              â†“                             â†“                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Pool 3: å€™é€‰æ±         â”‚      â”‚ Pool 2: å·²åˆ†ææœªå…¥å€™é€‰  â”‚       â”‚
â”‚  â”‚ (Candidates)        â”‚      â”‚ (Analyzed-NotQualified)â”‚      â”‚
â”‚  â”‚ - å·²åˆ†æï¼Œé«˜åˆ†       â”‚      â”‚ - å·²åˆ†æï¼Œä¸åˆæ ¼      â”‚       â”‚
â”‚  â”‚ - å¾…æ¨è             â”‚      â”‚ - score < é—¨æ§›æˆ–å…¶ä»–   â”‚       â”‚
â”‚  â”‚ - score â‰¥ é—¨æ§›      â”‚      â”‚ - é¿å…é‡å¤åˆ†æ        â”‚       â”‚
â”‚  â”‚ - æ ¸å¿ƒç¼“å†²åŒº         â”‚      â”‚ - ä¸éœ€è¦è§£å†»æœºåˆ¶      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚              â†“                                                â”‚
â”‚      æ¨èä»»åŠ¡ï¼ˆåŠ¨æ€è°ƒåº¦ï¼‰                                       â”‚
â”‚      ä»å€™é€‰æ± æŒ‘é€‰æœ€ä¼˜æ–‡ç«                                        â”‚
â”‚              â†“                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Pool 4: æ¨èæ±  (Recommendations)                        â”‚   â”‚
â”‚  â”‚ - çŠ¶æ€: active, å¾…ç”¨æˆ·æ¶ˆè´¹                              â”‚   â”‚
â”‚  â”‚ - å®¹é‡: maxRecommendations Ã— 2ï¼ˆå¼¹çª—å®¹é‡çš„ 2 å€ï¼‰        â”‚   â”‚
â”‚  â”‚ - æµå‡º: ç”¨æˆ·æ¶ˆè´¹ï¼ˆå·²è¯»/æ‹’ç»ï¼‰æˆ–è¿‡æœŸ                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â†“                                 â”‚
â”‚                      ç”¨æˆ·æ¶ˆè´¹ï¼ˆä¸å¯æ§ï¼‰                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ± å­è¯¦ç»†å®šä¹‰

#### Pool 1: åŸå§‹æ±  (Raw Pool)

**ä½œç”¨**ï¼šå­˜å‚¨æ‰€æœ‰æœªåˆ†æçš„æ–‡ç« ï¼ˆåŒ…æ‹¬å·²è¢«æºå‰”é™¤çš„ï¼‰

**å…³é”®è®¾è®¡**ï¼šèŒƒå›´æ˜¯"æœªåˆ†æ"è€Œé"åœ¨æºä¸­"ï¼Œé¿å…åˆ†æä¸åŠæ—¶å¯¼è‡´æ–‡ç« ä¸¢å¤±

**å­—æ®µ**ï¼š
```typescript
{
  inFeed: true/false,     // æ˜¯å¦åœ¨æºä¸­ï¼ˆå¯èƒ½å·²è¢«å‰”é™¤ï¼‰
  analysis: null,         // æœªåˆ†æ
  // ... å…¶ä»–å­—æ®µ
}
```

**æµå…¥**ï¼šè®¢é˜…æºè‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼ˆç‹¬ç«‹è¿è¡Œï¼‰

**æµå‡º**ï¼š
- AI åˆ†æå â†’ Pool 3 (é«˜åˆ†ï¼Œå…¥å€™é€‰) æˆ– Pool 2 (ä¸åˆæ ¼)
- è‡ªåŠ¨ç»´æŠ¤åˆ é™¤ä¹…è¿œæ–‡ç« ï¼ˆå¦‚ 30 å¤©å‰ï¼‰

**å®¹é‡**ï¼šæ— ä¸Šé™ï¼ˆè‡ªåŠ¨ç»´æŠ¤ï¼‰

**æŸ¥è¯¢**ï¼š
```typescript
db.feedArticles.where('analysis').equals(null).toArray()
```

---

#### Pool 2: å·²åˆ†ææœªå…¥å€™é€‰ (Analyzed-NotQualified)

**ä½œç”¨**ï¼šè®°å½•å·²åˆ†æä½†ä¸ç¬¦åˆæ¨èæ¡ä»¶çš„æ–‡ç« ï¼Œé¿å…é‡å¤åˆ†æ

**å­—æ®µ**ï¼š
```typescript
{
  inFeed: true/false,
  analysis: {
    score: number,        // < æ¨èé—¨æ§› æˆ–å…¶ä»–åŸå› 
    topics: {...},
    reason: string,       // "score_too_low" | "duplicate" | "low_quality"
    ...
  },
  isRecommended: false,
  poolStatus: 'analyzed-not-qualified',
}
```

**æµå…¥**ï¼š
- AI åˆ†æåï¼Œscore < é—¨æ§›
- AI åˆ†æåï¼Œåˆ¤æ–­ä¸ºé‡å¤/ä½è´¨é‡

**æµå‡º**ï¼š
- è‡ªåŠ¨åˆ é™¤ä¹…è¿œæ–‡ç« ï¼ˆå¦‚ 7 å¤©å‰ï¼‰
- **ä¸éœ€è¦è§£å†»/é‡æ–°åˆ†ææœºåˆ¶**

**å®¹é‡**ï¼šæœ‰ä¸Šé™ï¼ˆå¦‚ 5000 ç¯‡ï¼Œè¶…è¿‡åˆ é™¤æœ€æ—§çš„ï¼‰

**æŸ¥è¯¢**ï¼š
```typescript
db.feedArticles
  .where('poolStatus').equals('analyzed-not-qualified')
  .toArray()
```

---

#### Pool 3: å€™é€‰æ±  (Candidates)

**ä½œç”¨**ï¼šæ ¸å¿ƒç¼“å†²åŒºï¼Œå­˜å‚¨é«˜åˆ†æ–‡ç« ï¼Œç­‰å¾…æ¨è

**è¿™æ˜¯è§£å†³ä¹‹å‰é—®é¢˜çš„å…³é”®**ï¼šé¿å…æ–‡ç« åˆ†æåç«‹å³æ¨èå¯¼è‡´æ¨èæ± å †ç§¯

**å­—æ®µ**ï¼š
```typescript
{
  inFeed: true/false,
  analysis: {
    score: number,        // â‰¥ æ¨èé—¨æ§›
    topics: {...},
    ...
  },
  isRecommended: false,
  poolStatus: 'candidate',
  candidateAt: timestamp, // è¿›å…¥å€™é€‰æ± æ—¶é—´
}
```

**æµå…¥**ï¼šAI åˆ†æåï¼Œscore â‰¥ é—¨æ§›çš„æ–‡ç« 

**æµå‡º**ï¼š
- æ¨èä»»åŠ¡é€‰ä¸­ â†’ Pool 4 (æ¨èæ± )
- è¿‡æœŸæˆ–æ–‡ç« è¢«åˆ é™¤ â†’ æ¸…ç†

**å®¹é‡**ï¼šåŠ¨æ€ï¼ˆAI å†³å®šä¿æŒå¤šå°‘å€™é€‰ï¼Œå¦‚ 20-100 ç¯‡ï¼‰

**æ’åº**ï¼š
- ä¸»æ’åºï¼šscore é™åº
- æ¬¡æ’åºï¼šæ—¶æ•ˆæ€§ï¼ˆæ–°é²œåº¦ï¼‰
- å¯é€‰ï¼šå¤šæ ·æ€§ï¼ˆé¿å…åŒä¸€ä¸»é¢˜è¿‡å¤šï¼‰

**æŸ¥è¯¢**ï¼š
```typescript
db.feedArticles
  .where('poolStatus').equals('candidate')
  .sortBy('analysis.score')
  .then(articles => articles.reverse())
```

---

#### Pool 4: æ¨èæ±  (Recommendations)

**ä½œç”¨**ï¼šå­˜å‚¨å¾…å±•ç¤ºç»™ç”¨æˆ·çš„æ¨è

**è¡¨**ï¼š`Recommendations` è¡¨ï¼ˆå·²æœ‰ï¼‰

**å­—æ®µ**ï¼š
```typescript
{
  articleId: string,
  score: number,
  reason: string,
  status: 'active' | 'read' | 'dismissed',
  isRead: boolean,
  feedback: null | 'liked' | 'dismissed',
  recommendedAt: timestamp,
}
```

**æµå…¥**ï¼šæ¨èä»»åŠ¡ä» Pool 3 (å€™é€‰æ± ) é€‰å‡ºé«˜åˆ†æ–‡ç« 

**æµå‡º**ï¼š
- ç”¨æˆ·æ¶ˆè´¹ï¼ˆå·²è¯»/æ‹’ç»ï¼‰
- è¿‡æœŸè‡ªåŠ¨æ¸…ç†

**å®¹é‡**ï¼šmaxRecommendations Ã— 2ï¼ˆä¾‹å¦‚ 3 Ã— 2 = 6ï¼‰

---

## AI ç­–ç•¥å†³ç­–

### ç­–ç•¥å‚æ•°åŒ–

AI ä¸å†ç»™å‡º"å›ºå®šè§„åˆ™"ï¼Œè€Œæ˜¯ç»™å‡º**å‚æ•°åŒ–çš„åŠ¨æ€ç­–ç•¥**ï¼ˆå¸¦åˆç†èŒƒå›´çº¦æŸï¼‰ï¼š

```typescript
interface RecommendationStrategy {
  // 1. åˆ†æç­–ç•¥
  analysis: {
    batchSize: number,                     // æ¯æ¬¡åˆ†æå‡ ç¯‡ [èŒƒå›´: 1-20]
    scoreThreshold: number,                // æ¨èé—¨æ§›ï¼ˆåŠ¨æ€ï¼‰[èŒƒå›´: 6.0-8.5]
    prioritySource: string[],              // ä¼˜å…ˆåˆ†æçš„è®¢é˜…æºï¼ˆå¯é€‰ï¼‰
  },
  
  // 2. æ¨èç­–ç•¥
  recommendation: {
    targetPoolSize: number,                // ç›®æ ‡æ¨èæ± å®¹é‡ [èŒƒå›´: 3-10]
    refillThreshold: number,               // è¡¥å……é˜ˆå€¼ï¼ˆæ± å­é™åˆ°å¤šå°‘æ—¶è§¦å‘ï¼‰[èŒƒå›´: 1-5]
    dailyLimit: number,                    // æ¯æ—¥æ¨èä¸Šé™ [èŒƒå›´: 5-30]
    cooldownMinutes: number,               // è¡¥å……å†·å´æ—¶é—´ [èŒƒå›´: 30-180]
  },
  
  // 3. è°ƒåº¦ç­–ç•¥
  scheduling: {
    analysisIntervalMinutes: number,       // åˆ†æä»»åŠ¡é—´éš” [èŒƒå›´: 1-60]
    recommendIntervalMinutes: number,      // æ¨èä»»åŠ¡é—´éš” [èŒƒå›´: 1-60]
    loopIterations: number,                // æ¯æ¬¡ä»»åŠ¡å¾ªç¯æ¬¡æ•° [èŒƒå›´: 1-10]
  },
  
  // 4. å€™é€‰æ± ç®¡ç†
  candidatePool: {
    targetSize: number,                    // ç›®æ ‡å®¹é‡ [èŒƒå›´: 10-100]
    maxSize: number,                       // æœ€å¤§å®¹é‡ [èŒƒå›´: 20-200]
    expiryHours: number,                   // è¿‡æœŸæ—¶é—´ [èŒƒå›´: 24-168 (1-7å¤©)]
  },
  
  // 5. ç­–ç•¥å…ƒä¿¡æ¯
  meta: {
    reason: string,                        // ç­–ç•¥åŸå› ï¼ˆç®€æ´ï¼Œ1-2å¥è¯ï¼‰
    confidence: number,                    // ç½®ä¿¡åº¦ (0-1)
    validHours: number,                    // æœ‰æ•ˆæœŸï¼ˆå°æ—¶ï¼‰[èŒƒå›´: 12-48]
  }
}
```

**å‚æ•°çº¦æŸåå¤„ç†**ï¼šç¨‹åºæ”¶åˆ° AI è¾“å‡ºåï¼Œä¼šè‡ªåŠ¨ä¿®æ­£è¶…å‡ºèŒƒå›´çš„å€¼
```

### AI å†³ç­–è¾“å…¥

AI åŸºäºä»¥ä¸‹å®æ—¶æ•°æ®åšå†³ç­–ï¼š

```typescript
interface StrategyDecisionContext {
  // 1. ä¾›ç»™ä¾§æ•°æ®
  supply: {
    totalFeeds: number,                    // è®¢é˜…æºæ€»æ•°
    activeFeeds: number,                   // æ´»è·ƒè®¢é˜…æºæ•°
    avgUpdateFrequency: number,            // å¹³å‡æ›´æ–°é¢‘ç‡ï¼ˆå°æ—¶ï¼‰
    dailyNewArticles: number,              // æ¯æ—¥æ–°æ–‡ç« æ•°
    rawPoolSize: number,                   // Pool 1 å®¹é‡
    candidatePoolSize: number,             // Pool 2 å®¹é‡
    frozenPoolSize: number,                // Pool 3 å®¹é‡
  },
  
  // 2. éœ€æ±‚ä¾§æ•°æ®
  demand: {
    dailyReadCount: number,                // ç”¨æˆ·æ¯æ—¥é˜…è¯»æ•°
    avgReadSpeed: number,                  // å¹³å‡é˜…è¯»é€Ÿåº¦ï¼ˆç¯‡/å¤©ï¼‰
    dismissRate: number,                   // æ‹’ç»ç‡
    likeRate: number,                      // å–œæ¬¢ç‡
    recommendationPoolSize: number,        // Pool 4 å½“å‰å®¹é‡
    recommendationPoolCapacity: number,    // Pool 4 æœ€å¤§å®¹é‡
  },
  
  // 3. ç³»ç»ŸçŠ¶æ€
  system: {
    aiTokensUsedToday: number,             // ä»Šæ—¥ token æ¶ˆè€—
    aiTokensBudget: number,                // æ¯æ—¥ token é¢„ç®—
    aiCostToday: number,                   // ä»Šæ—¥æˆæœ¬
    analyzedArticlesToday: number,         // ä»Šæ—¥åˆ†ææ•°
    recommendedArticlesToday: number,      // ä»Šæ—¥æ¨èæ•°
  },
  
  // 4. å†å²æ•°æ®
  history: {
    last7DaysReadCount: number,            // è¿‡å» 7 å¤©é˜…è¯»æ•°
    last7DaysRecommendedCount: number,     // è¿‡å» 7 å¤©æ¨èæ•°
    last7DaysAnalyzedCount: number,        // è¿‡å» 7 å¤©åˆ†ææ•°
    avgScoreDistribution: {...},          // åˆ†æ•°åˆ†å¸ƒ
  },
  
  // 5. ç”¨æˆ·ç”»åƒ
  userProfile: {
    pageVisitCount: number,                // æµè§ˆé¡µé¢æ•°
    onboardingComplete: boolean,           // æ˜¯å¦å®Œæˆå¼•å¯¼
    topTopics: string[],                   // ä¸»è¦å…´è¶£
    profileConfidence: number,             // ç”»åƒç½®ä¿¡åº¦
  }
}
```

### AI å†³ç­– Prompt

```markdown
ä½ æ˜¯ Silent Feed æ¨èç³»ç»Ÿçš„ç­–ç•¥å†³ç­–å¼•æ“ã€‚

## ä½ çš„ä»»åŠ¡

æ ¹æ®å½“å‰ç³»ç»ŸçŠ¶æ€ï¼Œç»™å‡ºä¸€ä¸ªå‚æ•°åŒ–çš„æ¨èç­–ç•¥ï¼Œä»¥è¾¾åˆ°ä»¥ä¸‹ç›®æ ‡ï¼š

1. **å¹³è¡¡ä¾›éœ€**ï¼šè®©æ¨èæ± ä¿æŒåœ¨åˆç†å®¹é‡ï¼Œé¿å…è¿‡è½½æˆ–ä¸è¶³
2. **ä¼˜åŒ–æˆæœ¬**ï¼šåœ¨ AI æˆæœ¬é¢„ç®—å†…ï¼Œæœ€å¤§åŒ–æ¨èè´¨é‡
3. **æå‡ä½“éªŒ**ï¼šè®©ç”¨æˆ·å§‹ç»ˆæœ‰é«˜è´¨é‡å†…å®¹å¯è¯»ï¼Œä¸å †ç§¯ä¸æ¯ç«­

## å½“å‰çŠ¶æ€

### ä¾›ç»™ä¾§
- è®¢é˜…æº: {{totalFeeds}} ä¸ªï¼ˆæ´»è·ƒ {{activeFeeds}} ä¸ªï¼‰
- å¹³å‡æ›´æ–°é¢‘ç‡: æ¯ {{avgUpdateFrequency}} å°æ—¶
- æ¯æ—¥æ–°æ–‡ç« : {{dailyNewArticles}} ç¯‡
- åŸå§‹æ–‡ç« æ± : {{rawPoolSize}} ç¯‡ï¼ˆæœªåˆ†æï¼‰
- å€™é€‰æ± : {{candidatePoolSize}} ç¯‡ï¼ˆé«˜åˆ†å¾…æ¨èï¼‰
- å†·å†»æ± : {{frozenPoolSize}} ç¯‡ï¼ˆä½åˆ†å·²å†·å†»ï¼‰

### éœ€æ±‚ä¾§
- ç”¨æˆ·é˜…è¯»é€Ÿåº¦: æ¯å¤© {{avgReadSpeed}} ç¯‡
- æ‹’ç»ç‡: {{dismissRate}}%
- å–œæ¬¢ç‡: {{likeRate}}%
- æ¨èæ± : {{recommendationPoolSize}}/{{recommendationPoolCapacity}} ç¯‡

### ç³»ç»ŸçŠ¶æ€
- ä»Šæ—¥ AI æˆæœ¬: ${{aiCostToday}} / ${{aiTokensBudget}} (é¢„ç®—)
- ä»Šæ—¥å·²åˆ†æ: {{analyzedArticlesToday}} ç¯‡
- ä»Šæ—¥å·²æ¨è: {{recommendedArticlesToday}} ç¯‡

### å†å²è¶‹åŠ¿
- è¿‡å» 7 å¤©é˜…è¯»: {{last7DaysReadCount}} ç¯‡
- è¿‡å» 7 å¤©æ¨è: {{last7DaysRecommendedCount}} ç¯‡
- è¿‡å» 7 å¤©åˆ†æ: {{last7DaysAnalyzedCount}} ç¯‡

## å†³ç­–ç»´åº¦

### 1. åˆ†æç­–ç•¥
- **é¢‘ç‡**: å¤šä¹…åˆ†æä¸€æ¬¡åŸå§‹æ–‡ç« ï¼Ÿï¼ˆè€ƒè™‘ï¼šåŸå§‹æ± å¤§å°ã€AI é¢„ç®—ã€å€™é€‰æ± åº“å­˜ï¼‰
- **æ‰¹æ¬¡**: æ¯æ¬¡åˆ†æå‡ ç¯‡ï¼Ÿï¼ˆè€ƒè™‘ï¼šæ•ˆç‡ã€è¶…æ—¶é£é™©ã€æˆæœ¬ï¼‰
- **é—¨æ§›**: score å¤šå°‘ä»¥ä¸Šæ‰æ¨èï¼Ÿï¼ˆè€ƒè™‘ï¼šå€™é€‰æ± è´¨é‡ã€ç”¨æˆ·åé¦ˆï¼‰

### 2. æ¨èç­–ç•¥
- **ç›®æ ‡å®¹é‡**: æ¨èæ± åº”è¯¥ä¿æŒå¤šå°‘ç¯‡ï¼Ÿï¼ˆè€ƒè™‘ï¼šç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ã€è´¨é‡ä¿è¯ï¼‰
- **è¡¥å……é˜ˆå€¼**: é™åˆ°å¤šå°‘æ—¶è§¦å‘è¡¥å……ï¼Ÿï¼ˆè€ƒè™‘ï¼šé¿å…ç©ºæ± ã€é¿å…é¢‘ç¹è¡¥å……ï¼‰
- **å†·å´æ—¶é—´**: ä¸¤æ¬¡è¡¥å……é—´éš”å¤šä¹…ï¼Ÿï¼ˆè€ƒè™‘ï¼šç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ã€é¿å…å †ç§¯ï¼‰

### 3. è°ƒåº¦ç­–ç•¥
- **åˆ†æé—´éš”**: åˆ†æä»»åŠ¡å¤šä¹…è§¦å‘ä¸€æ¬¡ï¼Ÿï¼ˆè€ƒè™‘ï¼šåŸå§‹æ± å¢é•¿é€Ÿåº¦ã€AI æˆæœ¬ï¼‰
- **æ¨èé—´éš”**: æ¨èä»»åŠ¡å¤šä¹…è§¦å‘ä¸€æ¬¡ï¼Ÿï¼ˆè€ƒè™‘ï¼šå€™é€‰æ± åº“å­˜ã€ç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ï¼‰
- **å¾ªç¯æ¬¡æ•°**: æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œå‡ è½®ï¼Ÿï¼ˆè€ƒè™‘ï¼šæ•ˆç‡ã€è¶…æ—¶é£é™©ï¼‰

### 4. æ± å­ç®¡ç†
- **å€™é€‰æ± å®¹é‡**: ä¿æŒå¤šå°‘é«˜åˆ†æ–‡ç« ï¼Ÿï¼ˆè€ƒè™‘ï¼šä¿è¯ä¾›åº”ã€é¿å…è¿‡æœŸï¼‰
- **å†·å†»æ± å®¹é‡**: ä¿ç•™å¤šå°‘ä½åˆ†æ–‡ç« ï¼Ÿï¼ˆè€ƒè™‘ï¼šé¿å…é‡å¤åˆ†æã€å­˜å‚¨æˆæœ¬ï¼‰

## è¾“å‡ºæ ¼å¼

è¯·ä»¥ JSON æ ¼å¼è¾“å‡ºç­–ç•¥ï¼ŒåŒ…å«æ‰€æœ‰å‚æ•°å’Œå†³ç­–ç†ç”±ï¼š

```json
{
  "analysis": {
    "frequency": "medium",
    "batchSize": 10,
    "scoreThreshold": 7.0,
    "prioritySource": []
  },
  "recommendation": {
    "targetPoolSize": 6,
    "refillThreshold": 2,
    "dailyLimit": 20,
    "cooldownMinutes": 60
  },
  "scheduling": {
    "analysisIntervalMinutes": 5,
    "recommendIntervalMinutes": 10,
    "loopIterations": 3
  },
  "candidatePool": {
    "maxSize": 50,
    "expiryHours": 48,
    "reEvaluate": false
  },
  "frozenPool": {
    "maxSize": 1000,
    "ttlDays": 7,
    "reAnalyze": false
  },
  "meta": {
    "reason": "å½“å‰åŸå§‹æ± æœ‰ 50 ç¯‡æœªåˆ†ææ–‡ç« ï¼Œä½†æ¨èæ± å……è¶³ï¼ˆ4/6ï¼‰ï¼Œç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ä¸­ç­‰ï¼ˆ2ç¯‡/å¤©ï¼‰ï¼Œå› æ­¤é‡‡ç”¨ä¸­ç­‰åˆ†æé¢‘ç‡ï¼Œæ¯ 5 åˆ†é’Ÿåˆ†æ 10 ç¯‡ï¼Œé—¨æ§›ä¿æŒ 7.0 ä»¥ç¡®ä¿è´¨é‡ã€‚æ¨èæ± ç›®æ ‡ 6 ç¯‡ï¼Œé™åˆ° 2 ç¯‡æ—¶è¡¥å……ï¼Œå†·å´ 60 åˆ†é’Ÿé¿å…è¿‡åº¦æ¨èã€‚",
    "confidence": 0.85,
    "validUntil": {{timestamp + 24h}},
    "nextReview": {{timestamp + 12h}}
  }
}
```

## å†³ç­–åŸåˆ™

1. **ä¾›éœ€å¹³è¡¡**: å¦‚æœåŸå§‹æ± å¢é•¿å¿«ã€ç”¨æˆ·æ¶ˆè´¹æ…¢ â†’ é™ä½åˆ†æé¢‘ç‡ã€æé«˜é—¨æ§›
2. **æˆæœ¬ä¼˜åŒ–**: å¦‚æœæ¥è¿‘é¢„ç®— â†’ é™ä½åˆ†æé¢‘ç‡ã€å‡å°‘æ‰¹æ¬¡
3. **è´¨é‡ä¼˜å…ˆ**: å®å¯æ¨èå°‘ï¼Œä¸å¯æ¨èå·®
4. **åŠ¨æ€è°ƒæ•´**: ç­–ç•¥åº”è¯¥éšç€æ•°æ®å˜åŒ–è€Œå˜åŒ–ï¼Œæ¯ 12-24 å°æ—¶å®¡æŸ¥ä¸€æ¬¡
```

---

## å®æ–½æ–¹æ¡ˆ

### Phase 1: æ•°æ®æ¨¡å‹æ‰©å±•

**ç›®æ ‡**ï¼šæ”¯æŒå¤šæ± æ¶æ„

#### 1.1 æ‰©å±• FeedArticle è¡¨

```typescript
// src/types/feed.ts
export interface FeedArticle {
  // ... ç°æœ‰å­—æ®µ
  
  // æ–°å¢å­—æ®µ
  poolStatus: 'raw' | 'candidate' | 'frozen' | 'recommended',  // æ± å­çŠ¶æ€
  frozenAt?: number,                                            // å†·å†»æ—¶é—´
  frozenReason?: string,                                        // å†·å†»åŸå› 
  isRecommended?: boolean,                                      // æ˜¯å¦å·²è¢«æ¨è
}
```

#### 1.2 åˆ›å»º StrategyDecision è¡¨

```typescript
// src/types/strategy.ts
export interface StrategyDecision {
  id: string,
  createdAt: number,
  validUntil: number,
  nextReview: number,
  
  // å†³ç­–ä¸Šä¸‹æ–‡ï¼ˆå¿«ç…§ï¼‰
  context: StrategyDecisionContext,
  
  // AI è¾“å‡ºçš„ç­–ç•¥
  strategy: RecommendationStrategy,
  
  // æ‰§è¡Œç»“æœï¼ˆç”¨äºå­¦ä¹ ï¼‰
  execution?: {
    appliedAt: number,
    analyzedCount: number,
    recommendedCount: number,
    effectiveness: number,  // 0-1ï¼ŒåŸºäºç”¨æˆ·åé¦ˆ
  }
}
```

---

### Phase 2: ç­–ç•¥å†³ç­–æœåŠ¡

**ç›®æ ‡**ï¼šAI é©±åŠ¨çš„ç­–ç•¥å†³ç­–

#### 2.1 StrategyDecisionService

```typescript
// src/core/strategy/StrategyDecisionService.ts
export class StrategyDecisionService {
  /**
   * è¯·æ±‚æ–°ç­–ç•¥ï¼ˆæ¯ 12-24 å°æ—¶è°ƒç”¨ä¸€æ¬¡ï¼‰
   */
  async requestNewStrategy(): Promise<RecommendationStrategy> {
    // 1. æ”¶é›†å†³ç­–ä¸Šä¸‹æ–‡
    const context = await this.collectContext()
    
    // 2. è°ƒç”¨ AI å†³ç­–
    const strategy = await this.callAIDecision(context)
    
    // 3. éªŒè¯ç­–ç•¥åˆç†æ€§
    const validated = this.validateStrategy(strategy)
    
    // 4. ä¿å­˜å†³ç­–è®°å½•
    await this.saveDecision(context, validated)
    
    // 5. è¿”å›ç­–ç•¥
    return validated
  }
  
  /**
   * è·å–å½“å‰æœ‰æ•ˆç­–ç•¥
   */
  async getCurrentStrategy(): Promise<RecommendationStrategy | null> {
    const decision = await db.strategyDecisions
      .orderBy('createdAt')
      .reverse()
      .first()
    
    if (!decision) return null
    if (Date.now() > decision.validUntil) return null
    
    return decision.strategy
  }
  
  /**
   * æ”¶é›†å†³ç­–ä¸Šä¸‹æ–‡
   */
  private async collectContext(): Promise<StrategyDecisionContext> {
    // ä» SystemStatsã€DB ç­‰æ”¶é›†æ•°æ®
    // ...
  }
  
  /**
   * è°ƒç”¨ AI å†³ç­–
   */
  private async callAIDecision(
    context: StrategyDecisionContext
  ): Promise<RecommendationStrategy> {
    const capability = AICapabilityManager.getInstance()
    
    const prompt = this.buildDecisionPrompt(context)
    
    const response = await capability.callAI('strategyDecision', {
      prompt,
      temperature: 0.3,  // è¾ƒä½æ¸©åº¦ï¼Œä¿è¯ç¨³å®šæ€§
    })
    
    return JSON.parse(response)
  }
}
```

---

### Phase 3: è°ƒåº¦å™¨é‡æ„

**ç›®æ ‡**ï¼šæ ¹æ®ç­–ç•¥åŠ¨æ€è°ƒæ•´è°ƒåº¦è¡Œä¸º

#### 3.1 AnalysisSchedulerï¼ˆåˆ†æè°ƒåº¦å™¨ï¼‰

```typescript
// src/background/analysis-scheduler.ts
export class AnalysisScheduler {
  private strategy: RecommendationStrategy | null = null
  
  async start() {
    // 1. è·å–å½“å‰ç­–ç•¥
    this.strategy = await strategyService.getCurrentStrategy()
    
    if (!this.strategy) {
      // 2. è¯·æ±‚æ–°ç­–ç•¥
      this.strategy = await strategyService.requestNewStrategy()
    }
    
    // 3. æ ¹æ®ç­–ç•¥è®¾ç½® Alarm
    const interval = this.strategy.scheduling.analysisIntervalMinutes
    await chrome.alarms.create('analysis', { periodInMinutes: interval })
  }
  
  async handleAlarm() {
    const strategy = await this.ensureValidStrategy()
    
    // æ ¹æ®ç­–ç•¥å¾ªç¯æ‰§è¡Œ
    const iterations = strategy.scheduling.loopIterations
    const batchSize = strategy.analysis.batchSize
    
    for (let i = 0; i < iterations; i++) {
      // ä» Pool 1 è·å–æ–‡ç« 
      const articles = await this.getRawArticles(batchSize)
      if (articles.length === 0) break
      
      // åˆ†ææ–‡ç« 
      const results = await this.analyzeArticles(articles, strategy)
      
      // æ ¹æ® score åˆ†æµåˆ° Pool 2 æˆ– Pool 3
      await this.distributeArticles(results, strategy.analysis.scoreThreshold)
      
      // æ£€æŸ¥æ˜¯å¦ç»§ç»­
      if (await this.shouldStopAnalysis(strategy)) break
      
      // é—´éš”
      await sleep(5000)
    }
  }
  
  private async distributeArticles(
    results: AnalysisResult[],
    threshold: number
  ) {
    for (const result of results) {
      if (result.score >= threshold) {
        // â†’ Pool 2: å€™é€‰æ± 
        await db.feedArticles.update(result.articleId, {
          poolStatus: 'candidate',
          analysis: result.analysis,
        })
      } else {
        // â†’ Pool 3: å†·å†»æ± 
        await db.feedArticles.update(result.articleId, {
          poolStatus: 'frozen',
          analysis: result.analysis,
          frozenAt: Date.now(),
          frozenReason: `score ${result.score} < threshold ${threshold}`,
        })
      }
    }
  }
}
```

#### 3.2 RecommendationSchedulerï¼ˆæ¨èè°ƒåº¦å™¨ï¼‰

```typescript
// src/background/recommendation-scheduler.ts
export class RecommendationScheduler {
  private strategy: RecommendationStrategy | null = null
  
  async start() {
    this.strategy = await this.ensureValidStrategy()
    
    const interval = this.strategy.scheduling.recommendIntervalMinutes
    await chrome.alarms.create('recommendation', { periodInMinutes: interval })
  }
  
  async handleAlarm() {
    const strategy = await this.ensureValidStrategy()
    
    // 1. æ£€æŸ¥æ¨èæ± å®¹é‡
    const currentSize = await this.getRecommendationPoolSize()
    const targetSize = strategy.recommendation.targetPoolSize
    const threshold = strategy.recommendation.refillThreshold
    
    if (currentSize >= threshold) {
      // æ¨èæ± å……è¶³ï¼Œè·³è¿‡
      return
    }
    
    // 2. æ£€æŸ¥å†·å´æ—¶é—´
    const lastRefill = await this.getLastRefillTime()
    const cooldown = strategy.recommendation.cooldownMinutes * 60 * 1000
    if (Date.now() - lastRefill < cooldown) {
      // å†·å´ä¸­ï¼Œè·³è¿‡
      return
    }
    
    // 3. ä» Pool 2 é€‰æ‹©æ–‡ç« 
    const needed = targetSize - currentSize
    const candidates = await this.getCandidates(needed)
    
    // 4. åˆ›å»ºæ¨è
    for (const article of candidates) {
      await this.createRecommendation(article)
      
      // æ ‡è®°æ–‡ç« çŠ¶æ€
      await db.feedArticles.update(article.id, {
        poolStatus: 'recommended',
        isRecommended: true,
      })
    }
    
    // 5. è®°å½•è¡¥å……æ—¶é—´
    await this.recordRefill()
  }
  
  private async getCandidates(count: number): Promise<FeedArticle[]> {
    return await db.feedArticles
      .where('poolStatus').equals('candidate')
      .sortBy('analysis.score')
      .then(articles => articles.reverse().slice(0, count))
  }
}
```

---

### Phase 4: ç­–ç•¥å®¡æŸ¥æœºåˆ¶

**ç›®æ ‡**ï¼šå®šæœŸå®¡æŸ¥ç­–ç•¥æœ‰æ•ˆæ€§ï¼Œè§¦å‘é‡æ–°å†³ç­–

#### 4.1 StrategyReviewScheduler

```typescript
// src/background/strategy-review-scheduler.ts
export class StrategyReviewScheduler {
  async start() {
    // æ¯ 12 å°æ—¶æ£€æŸ¥ä¸€æ¬¡
    await chrome.alarms.create('strategy-review', { periodInMinutes: 12 * 60 })
  }
  
  async handleAlarm() {
    const strategy = await strategyService.getCurrentStrategy()
    
    if (!strategy) {
      // æ— ç­–ç•¥ï¼Œç«‹å³è¯·æ±‚
      await strategyService.requestNewStrategy()
      return
    }
    
    // æ£€æŸ¥æ˜¯å¦åˆ°è¾¾å®¡æŸ¥æ—¶é—´
    if (Date.now() >= strategy.meta.nextReview) {
      await strategyService.requestNewStrategy()
    }
  }
}
```

---

## æ€»ç»“

### æ¶æ„ä¼˜åŠ¿

1. **åŠ¨æ€é€‚åº”**ï¼šæ ¹æ®å®æ—¶ä¾›éœ€æƒ…å†µè‡ªåŠ¨è°ƒæ•´ç­–ç•¥
2. **AI é©±åŠ¨**ï¼šè®© AI å¤„ç†å¤æ‚å†³ç­–ï¼Œäººç±»åªéœ€å®šä¹‰ç›®æ ‡
3. **é€æ˜å¯è¿½æº¯**ï¼šæ–‡ç« åœ¨å„æ± å­é—´æµè½¬æ¸…æ™°ï¼Œç­–ç•¥å†³ç­–æœ‰è®°å½•
4. **æˆæœ¬å¯æ§**ï¼šAI åœ¨é¢„ç®—å†…ä¼˜åŒ–æ¨èè´¨é‡
5. **ç”¨æˆ·ä¸ºä¸­å¿ƒ**ï¼šä»¥ç”¨æˆ·æ¶ˆè´¹é€Ÿåº¦ä¸ºé”šç‚¹åå‘è°ƒæ•´

### å®æ–½è·¯å¾„

**Phase 1** (æ•°æ®æ¨¡å‹): 2-3 å¤©
**Phase 2** (ç­–ç•¥å†³ç­–): 3-4 å¤©
**Phase 3** (è°ƒåº¦å™¨é‡æ„): 4-5 å¤©
**Phase 4** (ç­–ç•¥å®¡æŸ¥): 1-2 å¤©

**æ€»è®¡**: çº¦ 2 å‘¨

### åç»­ä¼˜åŒ–

- Pool 2 å€™é€‰æ± çš„ä¼˜å…ˆçº§æ’åºï¼ˆä¸åªæ˜¯ scoreï¼Œè¿˜æœ‰æ—¶æ•ˆæ€§ã€å¤šæ ·æ€§ï¼‰
- Pool 3 å†·å†»æ± çš„é‡æ–°è¯„ä¼°æœºåˆ¶ï¼ˆç”¨æˆ·å…´è¶£å˜åŒ–åé‡æ–°åˆ†æï¼‰
- ç­–ç•¥çš„ A/B æµ‹è¯•ï¼ˆå¯¹æ¯”ä¸åŒç­–ç•¥çš„æ•ˆæœï¼‰
- ç”¨æˆ·åé¦ˆçš„é—­ç¯å­¦ä¹ ï¼ˆå°† dismissed/liked åé¦ˆç»™ AIï¼‰

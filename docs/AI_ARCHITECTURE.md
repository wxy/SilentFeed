# AI æ¶æ„æ–‡æ¡£

> **Silent Feed AI èƒ½åŠ›ç³»ç»Ÿå®Œæ•´æ¶æ„è¯´æ˜**
> 
> ç‰ˆæœ¬: v1.0  
> æ›´æ–°æ—¶é—´: 2025å¹´11æœˆ27æ—¥

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è§ˆ](#ç³»ç»Ÿæ¦‚è§ˆ)
2. [æ ¸å¿ƒèƒ½åŠ›](#æ ¸å¿ƒèƒ½åŠ›)
3. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
4. [AI æä¾›å•†](#ai-æä¾›å•†)
5. [ç±»å‹å®šä¹‰é—®é¢˜](#ç±»å‹å®šä¹‰é—®é¢˜)
6. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
7. [æ€§èƒ½ä¸æˆæœ¬](#æ€§èƒ½ä¸æˆæœ¬)

---

## ç³»ç»Ÿæ¦‚è§ˆ

Silent Feed çš„ AI ç³»ç»Ÿé‡‡ç”¨**ç»Ÿä¸€æŠ½è±¡å±‚ + å¤šæä¾›å•†**çš„æ¶æ„è®¾è®¡ï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹ AI æœåŠ¡ã€‚

### è®¾è®¡ç†å¿µ

- **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰ AI æä¾›å•†å®ç°ç›¸åŒçš„æ¥å£ï¼Œä¸šåŠ¡å±‚æ— æ„ŸçŸ¥åˆ‡æ¢
- **èƒ½åŠ›å¹³ç­‰**ï¼šæœ¬åœ° AI å’Œè¿œç¨‹ AI å…·æœ‰ç›¸åŒçš„èƒ½åŠ›ï¼ˆæ–‡ç« åˆ†æã€æ¨èç†ç”±ã€ç”¨æˆ·ç”»åƒï¼‰
- **é™çº§ç­–ç•¥**ï¼šAI ä¸å¯ç”¨æ—¶è‡ªåŠ¨é™çº§åˆ°å…³é”®è¯åˆ†æ
- **æˆæœ¬å¯æ§**ï¼šå®æ—¶è¿½è¸ª token æ¶ˆè€—å’Œ API æˆæœ¬

---

## æ ¸å¿ƒèƒ½åŠ›

æ‰€æœ‰ AI æä¾›å•†ï¼ˆåŒ…æ‹¬æœ¬åœ° Ollamaï¼‰éƒ½æ”¯æŒä»¥ä¸‹ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼š

### 1. å†…å®¹åˆ†æ (analyzeContent)

**åŠŸèƒ½**ï¼šåˆ†ææ–‡ç« å†…å®¹ï¼Œæå–ä¸»é¢˜æ¦‚ç‡åˆ†å¸ƒ

**è¾“å…¥**ï¼š
- æ–‡ç« å†…å®¹ï¼ˆæ–‡æœ¬ï¼‰
- å¯é€‰ï¼šç”¨æˆ·ç”»åƒï¼ˆå…´è¶£åå¥½ï¼‰
- å¯é€‰ï¼šæ¨ç†æ¨¡å¼

**è¾“å‡º**ï¼š
```typescript
{
  topicProbabilities: {
    "æŠ€æœ¯": 0.6,
    "å¼€æº": 0.3,
    "æ•™ç¨‹": 0.1
  },
  metadata: {
    provider: "ollama" | "deepseek" | "openai",
    model: "qwen2.5:7b",
    timestamp: 1732723200000,
    tokensUsed: {
      prompt: 150,
      completion: 50,
      total: 200
    },
    cost: 0.001  // äººæ°‘å¸
  }
}
```

**æ¨¡å¼**ï¼š
- **æ ‡å‡†æ¨¡å¼**ï¼šå¿«é€Ÿåˆ†æï¼Œæˆæœ¬ä½
- **æ¨ç†æ¨¡å¼**ï¼šæ·±åº¦æ€è€ƒï¼Œç²¾åº¦é«˜ï¼ˆä»…æ”¯æŒæ¨ç†æ¨¡å‹ï¼Œå¦‚ DeepSeek-R1ã€o1-miniï¼‰

---

### 2. æ¨èç†ç”±ç”Ÿæˆ (generateRecommendationReason)

**åŠŸèƒ½**ï¼šä¸ºæ¨èæ–‡ç« ç”Ÿæˆä¸ªæ€§åŒ–ç†ç”±

**è¾“å…¥**ï¼š
- æ–‡ç« æ ‡é¢˜å’Œæ‘˜è¦
- ç”¨æˆ·å…´è¶£å…³é”®è¯
- ç›¸å…³æ€§è¯„åˆ†
- å¯é€‰ï¼šè¯­ä¹‰åŒ–ç”¨æˆ·ç”»åƒ

**è¾“å‡º**ï¼š
```typescript
{
  reason: "è¿™ç¯‡æ–‡ç« æ·±å…¥ä»‹ç»äº† Rust çš„æ‰€æœ‰æƒç³»ç»Ÿï¼Œä¸ä½ å¯¹ç³»ç»Ÿç¼–ç¨‹å’Œå†…å­˜å®‰å…¨çš„å…´è¶£é«˜åº¦ç›¸å…³",
  matchedInterests: ["ç³»ç»Ÿç¼–ç¨‹", "å†…å­˜å®‰å…¨", "Rust"],
  confidence: 0.85,
  metadata: {
    provider: "ollama",
    model: "qwen2.5:7b",
    timestamp: 1732723200000,
    tokensUsed: {
      input: 200,
      output: 80,
      total: 280
    }
  }
}
```

---

### 3. ç”¨æˆ·ç”»åƒç”Ÿæˆ (generateUserProfile)

**åŠŸèƒ½**ï¼šåŸºäºç”¨æˆ·è¡Œä¸ºç”Ÿæˆæˆ–æ›´æ–°å…´è¶£ç”»åƒ

**è¾“å…¥**ï¼š
```typescript
{
  behaviors: {
    reads: [{ title, scrollDepth, readDuration }, ...],  // æ·±åº¦é˜…è¯»
    dismisses: [{ title, summary }, ...]                  // æ‹’ç»çš„æ–‡ç« 
  },
  topKeywords: [{ word, weight }, ...],                   // é«˜é¢‘å…³é”®è¯
  topicDistribution: { technology: 0.6, design: 0.3 },   // ä¸»é¢˜åˆ†å¸ƒ
  currentProfile: { interests, preferences, avoidTopics } // å¯é€‰ï¼šå¢é‡æ›´æ–°
}
```

**è¾“å‡º**ï¼š
```typescript
{
  interests: "å¯¹æŠ€æœ¯é¢†åŸŸæœ‰æµ“åšå…´è¶£ï¼Œç‰¹åˆ«å…³æ³¨å¼€æºè½¯ä»¶ã€ç¼–ç¨‹è¯­è¨€ã€ç³»ç»Ÿæ¶æ„ç­‰è¯é¢˜...",
  preferences: [
    "æŠ€æœ¯æ·±åº¦åˆ†æ",
    "å¼€æºè½¯ä»¶å®è·µ",
    "ç¼–ç¨‹è¯­è¨€ç‰¹æ€§",
    "ç³»ç»Ÿè®¾è®¡æ¡ˆä¾‹"
  ],
  avoidTopics: ["å¨±ä¹å…«å¦", "å¹¿å‘Šè¥é”€"],
  metadata: {
    provider: "ollama",
    model: "qwen2.5:7b",
    timestamp: 1732723200000,
    tokensUsed: {
      input: 500,
      output: 200
    },
    basedOn: {
      browses: 100,
      reads: 50,
      dismisses: 10
    },
    cost: 0.005
  }
}
```

---

## æ¶æ„è®¾è®¡

### å±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸šåŠ¡å±‚                                â”‚
â”‚  (æ¨èå¼•æ“ã€ç”¨æˆ·ç”»åƒç®¡ç†ã€å†…å®¹åˆ†æ)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AICapabilityManager                         â”‚
â”‚          (æ™ºèƒ½è°ƒåº¦ã€é™çº§ç­–ç•¥ã€æˆæœ¬æ§åˆ¶)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                BaseAIService                             â”‚
â”‚         (ç»Ÿä¸€æç¤ºè¯ã€é€šç”¨é€»è¾‘ã€ç±»å‹è½¬æ¢)                 â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚       â”‚        â”‚        â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â” â”Œâ–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚DeepSeekâ”‚ â”‚OpenAIâ”‚ â”‚Ollama â”‚ â”‚Claudeâ”‚ â”‚KeywordExtractor â”‚
â”‚Providerâ”‚ â”‚Providâ”‚ â”‚Provid â”‚ â”‚Providâ”‚ â”‚  (é™çº§ç­–ç•¥)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. BaseAIService (æŠ½è±¡åŸºç±»)

**èŒè´£**ï¼š
- ç»Ÿä¸€æç¤ºè¯æ¨¡æ¿ç®¡ç†
- é€šç”¨é€»è¾‘å¤ç”¨ï¼ˆé¢„å¤„ç†ã€å½’ä¸€åŒ–ã€æˆæœ¬è®¡ç®—ï¼‰
- å®šä¹‰æ ‡å‡†æ¥å£

**å­ç±»åªéœ€å®ç°**ï¼š
```typescript
// è°ƒç”¨ Chat-GPT å…¼å®¹çš„ API
protected abstract callChatAPI(
  prompt: string,
  options?: { maxTokens, timeout, jsonMode, useReasoning }
): Promise<{
  content: string,
  tokensUsed: { input: number, output: number },
  model?: string
}>

// å¯é€‰ï¼šè®¡ç®—æˆæœ¬
protected calculateCost(inputTokens, outputTokens): number
```

**æä¾›çš„èƒ½åŠ›**ï¼š
- âœ… `analyzeContent()` - å†…å®¹åˆ†æ
- âœ… `generateUserProfile()` - ç”¨æˆ·ç”»åƒç”Ÿæˆ
- âœ… `testConnection()` - è¿æ¥æµ‹è¯•
- âœ… `isAvailable()` - å¯ç”¨æ€§æ£€æŸ¥

**æç¤ºè¯æ¨¡æ¿**ï¼š
- `analyzeContent(content, userProfile?)` - æ ‡å‡†åˆ†æ
- `analyzeContentReasoning(content, userProfile?)` - æ¨ç†åˆ†æ
- `generateProfileFull(behaviorSummary)` - å…¨é‡ç”Ÿæˆç”»åƒ
- `generateProfileIncremental(behaviorSummary, currentProfile)` - å¢é‡æ›´æ–°ç”»åƒ

---

#### 2. AICapabilityManager (è°ƒåº¦ç®¡ç†å™¨)

**èŒè´£**ï¼š
- æ ¹æ®é…ç½®é€‰æ‹© AI æä¾›å•†
- è‡ªåŠ¨é™çº§å’Œé‡è¯•
- ç»Ÿä¸€é”™è¯¯å¤„ç†

**æ ¸å¿ƒæ–¹æ³•**ï¼š
```typescript
async initialize(): Promise<void>
async analyzeContent(content, options?): Promise<UnifiedAnalysisResult>
async generateRecommendationReason(request): Promise<RecommendationReasonResult>
async testConnection(): Promise<{ success, message, latency? }>
```

**é™çº§ç­–ç•¥**ï¼š
```
è¿œç¨‹ AI (DeepSeek/OpenAI) 
    â†“ (å¤±è´¥)
æœ¬åœ° AI (Ollama)
    â†“ (å¤±è´¥)
å…³é”®è¯æå– (TF-IDF)
```

---

## AI æä¾›å•†

### è¿œç¨‹ AI

#### 1. DeepSeek Provider

**ç‰¹ç‚¹**ï¼š
- âœ… æˆæœ¬æœ€ä½ï¼ˆ$0.14/MTok è¾“å…¥ï¼Œ$0.28/MTok è¾“å‡ºï¼‰
- âœ… å›½å†…è®¿é—®å‹å¥½ï¼ˆæ— éœ€ä»£ç†ï¼‰
- âœ… **æ”¯æŒæ¨ç†æ¨¡å¼**ï¼ˆDeepSeek-R1ï¼‰
- âœ… å®Œæ•´èƒ½åŠ›ï¼šå†…å®¹åˆ†æã€æ¨èç†ç”±ã€ç”¨æˆ·ç”»åƒ

**é…ç½®**ï¼š
```typescript
{
  provider: "deepseek",
  model: "deepseek-chat",  // æˆ– "deepseek-reasoner" (æ¨ç†æ¨¡å¼)
  apiKey: "sk-xxx",
  enableReasoning: true,   // å¯ç”¨æ¨ç†èƒ½åŠ›
  endpoint: "https://api.deepseek.com/v1"
}
```

**æ¨ç†æ¨¡å¼**ï¼š
- æ·±åº¦æ€è€ƒï¼Œåˆ†ææ›´å‡†ç¡®
- æˆæœ¬æ›´é«˜ï¼ˆçº¦ 3-5 å€ï¼‰
- é€‚åˆå¤æ‚å†…å®¹åˆ†æ

---

#### 2. OpenAI Provider

**ç‰¹ç‚¹**ï¼š
- âœ… è´¨é‡æœ€é«˜
- âœ… æ”¯æŒ Structured Outputs (JSON Schema)
- âœ… å®Œæ•´èƒ½åŠ›ï¼šå†…å®¹åˆ†æã€æ¨èç†ç”±ã€ç”¨æˆ·ç”»åƒ
- âŒ æˆæœ¬è¾ƒé«˜
- âŒ éœ€è¦ä»£ç†

**é…ç½®**ï¼š
```typescript
{
  provider: "openai",
  model: "gpt-4o-mini",  // æˆ– "o1-mini" (æ¨ç†æ¨¡å¼)
  apiKey: "sk-xxx",
  endpoint: "https://api.openai.com/v1"
}
```

---

### æœ¬åœ° AI

#### 3. Ollama Provider â­

**ç‰¹ç‚¹**ï¼š
- âœ… **å®Œå…¨å…è´¹**ï¼ˆæœ¬åœ°è¿è¡Œï¼‰
- âœ… **éšç§ä¿æŠ¤**ï¼ˆæ•°æ®ä¸ç¦»å¼€æœ¬åœ°ï¼‰
- âœ… **å®Œæ•´èƒ½åŠ›**ï¼šå†…å®¹åˆ†æã€æ¨èç†ç”±ã€ç”¨æˆ·ç”»åƒ
- âœ… æ”¯æŒå¤šç§å¼€æºæ¨¡å‹ï¼ˆQwenã€Llamaã€Mistralç­‰ï¼‰
- âœ… åŒç«¯ç‚¹å…¼å®¹ï¼ˆLegacy + OpenAI-compatibleï¼‰
- âš ï¸ éœ€è¦æœ¬åœ°éƒ¨ç½²
- âš ï¸ æ€§èƒ½å–å†³äºç¡¬ä»¶

**é…ç½®**ï¼š
```typescript
{
  provider: "ollama",
  endpoint: "http://localhost:11434",  // æˆ–è‡ªå®šä¹‰ç«¯å£
  model: "qwen2.5:7b",                 // æ¨èï¼šè½»é‡é«˜æ•ˆ
  temperature: 0.2,
  maxOutputTokens: 768,
  timeoutMs: 45000
}
```

**æ¨èæ¨¡å‹**ï¼š
- `qwen2.5:7b` - å¹³è¡¡æ€§èƒ½å’Œé€Ÿåº¦ï¼ˆæ¨èï¼‰
- `qwen2.5:14b` - æ›´é«˜ç²¾åº¦ï¼Œéœ€è¦æ›´å¤šèµ„æº
- `llama3.2:3b` - è½»é‡çº§ï¼Œé€Ÿåº¦å¿«
- `mistral:7b` - é€šç”¨èƒ½åŠ›å¼º

**åŒç«¯ç‚¹æ”¯æŒ**ï¼š
```typescript
// è‡ªåŠ¨æ¢æµ‹å’Œåˆ‡æ¢
endpoints: {
  legacy: {
    chat: "/api/chat",
    generate: "/api/generate",
    models: "/api/tags"
  },
  openai: {
    chat: "/v1/chat/completions",
    models: "/v1/models"
  }
}
```

**èƒ½åŠ›éªŒè¯**ï¼š
- âœ… å†…å®¹åˆ†æï¼šæ”¯æŒæ ‡å‡†å’Œ JSON æ¨¡å¼
- âœ… æ¨èç†ç”±ï¼šåŸºäºç”¨æˆ·ç”»åƒç”Ÿæˆä¸ªæ€§åŒ–ç†ç”±
- âœ… ç”¨æˆ·ç”»åƒï¼šå…¨é‡ç”Ÿæˆ + å¢é‡æ›´æ–°
- âœ… æˆæœ¬è®¡ç®—ï¼šå§‹ç»ˆè¿”å› 0ï¼ˆæœ¬åœ°å…è´¹ï¼‰

---

### é™çº§ç­–ç•¥

#### 4. KeywordExtractor (å…³é”®è¯æå–)

**ç‰¹ç‚¹**ï¼š
- âœ… å®Œå…¨ç¦»çº¿ï¼Œæ— ç½‘ç»œä¾èµ–
- âœ… é›¶æˆæœ¬
- âœ… å“åº”æå¿«
- âš ï¸ ç²¾åº¦è¾ƒä½

**å®ç°**ï¼š
- TF-IDF ç®—æ³•
- ä¸»é¢˜åˆ†ç±»è§„åˆ™
- å®ä½“è¯†åˆ«

---

## ç±»å‹å®šä¹‰é—®é¢˜

### âš ï¸ å½“å‰é—®é¢˜

åœ¨ç±»å‹å®šä¹‰ä¸­å­˜åœ¨ä¸ä¸€è‡´ï¼š

**UnifiedAnalysisResult** (å†…å®¹åˆ†æç»“æœ):
```typescript
tokensUsed?: {
  prompt: number      // âœ… ä½¿ç”¨ prompt
  completion: number  // âœ… ä½¿ç”¨ completion
  total: number
}
```

**UserProfileGenerationResult** (ç”¨æˆ·ç”»åƒç»“æœ):
```typescript
tokensUsed?: {
  input: number   // âŒ ä½¿ç”¨ input
  output: number  // âŒ ä½¿ç”¨ output
  // æ²¡æœ‰ total
}
```

**RecommendationReasonResult** (æ¨èç†ç”±ç»“æœ):
```typescript
tokensUsed?: {
  input: number   // âŒ ä½¿ç”¨ input
  output: number  // âŒ ä½¿ç”¨ output
  total?: number
}
```

### ğŸ”§ å»ºè®®ä¿®å¤

**æ–¹æ¡ˆ 1**ï¼šç»Ÿä¸€ä½¿ç”¨ `input/output`ï¼ˆOpenAI é£æ ¼ï¼‰
**æ–¹æ¡ˆ 2**ï¼šç»Ÿä¸€ä½¿ç”¨ `prompt/completion`ï¼ˆæ›´è¯­ä¹‰åŒ–ï¼‰

**æ¨èæ–¹æ¡ˆ 2**ï¼Œç†ç”±ï¼š
- æ›´æ¸…æ™°çš„è¯­ä¹‰ï¼ˆprompt = æç¤ºè¯ï¼Œcompletion = è¡¥å…¨ï¼‰
- ä¸ OpenAI æ–‡æ¡£æœ¯è¯­ä¸€è‡´
- ä¾¿äºç†è§£ token æ¶ˆè€—æ¥æº

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šå†…å®¹åˆ†æ

```typescript
import { AICapabilityManager } from '@/core/ai/AICapabilityManager'

const aiManager = new AICapabilityManager()
await aiManager.initialize()

// åˆ†ææ–‡ç« 
const result = await aiManager.analyzeContent(
  "æ·±å…¥ç†è§£ Rust çš„æ‰€æœ‰æƒç³»ç»Ÿ...",
  {
    userProfile: {
      interests: "ç³»ç»Ÿç¼–ç¨‹ã€å†…å­˜å®‰å…¨",
      preferences: ["æŠ€æœ¯æ·±åº¦åˆ†æ"],
      avoidTopics: ["å¨±ä¹å…«å¦"]
    },
    useReasoning: true  // å¯ç”¨æ¨ç†æ¨¡å¼ï¼ˆå¦‚æœæ”¯æŒï¼‰
  }
)

console.log(result.topicProbabilities)
// { "ç³»ç»Ÿç¼–ç¨‹": 0.7, "å†…å­˜å®‰å…¨": 0.2, "Rust": 0.1 }

console.log(result.metadata.cost)
// 0.002 (2åˆ†é’±)
```

---

### ç¤ºä¾‹ 2ï¼šç”¨æˆ·ç”»åƒç”Ÿæˆ

```typescript
const profile = await aiManager.generateUserProfile({
  behaviors: {
    reads: [
      { title: "Rust æ‰€æœ‰æƒæ·±åº¦è§£æ", scrollDepth: 0.9, readDuration: 300 },
      { title: "Linux å†…æ ¸å¼€å‘å…¥é—¨", scrollDepth: 0.8, readDuration: 250 }
    ],
    dismisses: [
      { title: "æ˜æ˜Ÿå…«å¦æ–°é—»", summary: "..." }
    ]
  },
  topKeywords: [
    { word: "Rust", weight: 0.8 },
    { word: "å†…å­˜å®‰å…¨", weight: 0.6 },
    { word: "ç³»ç»Ÿç¼–ç¨‹", weight: 0.5 }
  ],
  topicDistribution: {
    technology: 0.7,
    programming: 0.2,
    other: 0.1
  }
})

console.log(profile.interests)
// "å¯¹ç³»ç»Ÿç¼–ç¨‹æœ‰æµ“åšå…´è¶£ï¼Œç‰¹åˆ«å…³æ³¨ Rust è¯­è¨€ã€å†…å­˜å®‰å…¨æœºåˆ¶..."

console.log(profile.preferences)
// ["æŠ€æœ¯æ·±åº¦åˆ†æ", "ç³»ç»Ÿçº§ç¼–ç¨‹", "è¯­è¨€ç‰¹æ€§è§£è¯»"]

console.log(profile.avoidTopics)
// ["å¨±ä¹å…«å¦"]
```

---

### ç¤ºä¾‹ 3ï¼šæœ¬åœ° AI é…ç½®

```typescript
// ç”¨æˆ·åœ¨ AI é…ç½®é¡µé¢å¯ç”¨æœ¬åœ° AI
const aiConfig = {
  local: {
    enabled: true,
    provider: "ollama",
    endpoint: "http://localhost:11434/v1",
    model: "qwen2.5:7b",
    temperature: 0.2,
    maxOutputTokens: 768
  }
}

// æ¨èå¼•æ“è‡ªåŠ¨ä½¿ç”¨æœ¬åœ° AI
const recommendations = await generateRecommendations({
  analysisEngine: "localAI"  // ä¼˜å…ˆä½¿ç”¨æœ¬åœ° AI
})

// å¦‚æœæœ¬åœ° AI ä¸å¯ç”¨ï¼Œè‡ªåŠ¨é™çº§åˆ°è¿œç¨‹ AI
// å¦‚æœè¿œç¨‹ AI ä¹Ÿä¸å¯ç”¨ï¼Œé™çº§åˆ°å…³é”®è¯åˆ†æ
```

---

## æ€§èƒ½ä¸æˆæœ¬

### å“åº”æ—¶é—´å¯¹æ¯”

| æä¾›å•† | å†…å®¹åˆ†æ | æ¨èç†ç”± | ç”¨æˆ·ç”»åƒ |
|--------|---------|---------|---------|
| DeepSeek (æ ‡å‡†) | ~800ms | ~600ms | ~1200ms |
| DeepSeek (æ¨ç†) | ~2500ms | ~1500ms | ~3000ms |
| OpenAI (GPT-4o-mini) | ~700ms | ~500ms | ~1000ms |
| **Ollama (æœ¬åœ°)** | **~300ms** | **~200ms** | **~500ms** |
| å…³é”®è¯ (é™çº§) | <50ms | N/A | N/A |

### æˆæœ¬å¯¹æ¯”

| æä¾›å•† | æ¯æ¬¡åˆ†ææˆæœ¬ | æ¯æ—¥æˆæœ¬ (100æ¬¡) | æ¯æœˆæˆæœ¬ (3000æ¬¡) |
|--------|-------------|-----------------|------------------|
| DeepSeek (æ ‡å‡†) | Â¥0.001 | Â¥0.10 | Â¥3.00 |
| DeepSeek (æ¨ç†) | Â¥0.004 | Â¥0.40 | Â¥12.00 |
| OpenAI (GPT-4o-mini) | Â¥0.005 | Â¥0.50 | Â¥15.00 |
| **Ollama (æœ¬åœ°)** | **Â¥0** | **Â¥0** | **Â¥0** |
| å…³é”®è¯ | Â¥0 | Â¥0 | Â¥0 |

### æ¨èé…ç½®

**æ–¹æ¡ˆ 1ï¼šæˆæœ¬ä¼˜å…ˆ**
```typescript
{
  analysisEngine: "localAI",     // ä¼˜å…ˆæœ¬åœ°
  fallback: "remoteAI"           // é™çº§åˆ° DeepSeek
}
```

**æ–¹æ¡ˆ 2ï¼šè´¨é‡ä¼˜å…ˆ**
```typescript
{
  analysisEngine: "remoteAI",    // ä½¿ç”¨ OpenAI/DeepSeek
  useReasoning: true,            // å¯ç”¨æ¨ç†ï¼ˆç²¾åº¦æ›´é«˜ï¼‰
  fallback: "localAI"            // é™çº§åˆ°æœ¬åœ°
}
```

**æ–¹æ¡ˆ 3ï¼šå¹³è¡¡**
```typescript
{
  analysisEngine: "localAI",     // æ—¥å¸¸ä½¿ç”¨æœ¬åœ°
  useReasoning: false,           // æ ‡å‡†æ¨¡å¼å³å¯
  fallback: "remoteAI",          // æœ¬åœ°ä¸å¯ç”¨æ—¶ç”¨è¿œç¨‹
  qualityThreshold: 0.6          // ä½è´¨é‡å†…å®¹ç”¨è¿œç¨‹éªŒè¯
}
```

---

## æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

1. **èƒ½åŠ›å¹³ç­‰**ï¼šæ‰€æœ‰æä¾›å•†ï¼ˆåŒ…æ‹¬æœ¬åœ° Ollamaï¼‰éƒ½æ”¯æŒå®Œæ•´çš„ä¸‰å¤§èƒ½åŠ›
2. **ç»Ÿä¸€æ¥å£**ï¼šä¸šåŠ¡å±‚æ— éœ€å…³å¿ƒå…·ä½“ä½¿ç”¨å“ªä¸ª AI
3. **çµæ´»é™çº§**ï¼šè‡ªåŠ¨ä»è¿œç¨‹ â†’ æœ¬åœ° â†’ å…³é”®è¯
4. **æˆæœ¬å¯æ§**ï¼šå®æ—¶è¿½è¸ªï¼Œæ”¯æŒæœ¬åœ°å…è´¹æ–¹æ¡ˆ
5. **éšç§ä¿æŠ¤**ï¼šæœ¬åœ° AI æ•°æ®ä¸ç¦»å¼€è®¾å¤‡

### å¾…ä¼˜åŒ–

1. **ç±»å‹ä¸€è‡´æ€§**ï¼šç»Ÿä¸€ `tokensUsed` å­—æ®µåç§°
2. **ç¼“å­˜æœºåˆ¶**ï¼šé‡å¤å†…å®¹é¿å…é‡å¤è°ƒç”¨ AI
3. **æ‰¹å¤„ç†**ï¼šæ”¯æŒæ‰¹é‡åˆ†æé™ä½æˆæœ¬
4. **æ¨¡å‹åˆ‡æ¢**ï¼šæ”¯æŒè¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢æ¨¡å‹

---

## é™„å½•ï¼šæ–‡ä»¶ç»“æ„

```
src/core/ai/
â”œâ”€â”€ BaseAIService.ts              # AI æœåŠ¡åŸºç±»
â”œâ”€â”€ AICapabilityManager.ts        # è°ƒåº¦ç®¡ç†å™¨
â”œâ”€â”€ providers/
â”‚   â”œâ”€â”€ DeepSeekProvider.ts       # DeepSeek å®ç°
â”‚   â”œâ”€â”€ OpenAIProvider.ts         # OpenAI å®ç°
â”‚   â”œâ”€â”€ OllamaProvider.ts         # Ollama æœ¬åœ° AI
â”‚   â””â”€â”€ KeywordProvider.ts        # å…³é”®è¯é™çº§
â””â”€â”€ helpers.ts                    # å·¥å…·å‡½æ•°

src/types/ai.ts                   # AI ç±»å‹å®šä¹‰

src/utils/
â”œâ”€â”€ local-ai-endpoint.ts          # æœ¬åœ° AI ç«¯ç‚¹å·¥å…·
â””â”€â”€ analysis-engine-capability.ts # å¼•æ“èƒ½åŠ›æ£€æµ‹
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025å¹´11æœˆ27æ—¥  
**ç»´æŠ¤è€…**: Silent Feed Team

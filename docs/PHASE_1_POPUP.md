# 阶段 1.1: Popup 界面开发文档

**开发日期**: 2025-11-02  
**状态**: ✅ 开发完成，等待浏览器测试  
**分支**: `feature/phase1-popup`

---

## 一、功能目标

创建扩展的 Popup 弹窗界面，作为用户与扩展交互的主要入口。

### 核心功能
1. 显示扩展名称和产品简称
2. 显示当前初始化进度（0/1000 页）
3. 显示成长阶段图标（🌱探索者）
4. 提供设置入口

---

## 二、产品简称确定

**最终确定**: **"RSS 静音器"** ✅

**理由**:
- 无歧义，直接说明产品类型（RSS 相关）
- "静音器"突出核心功能：过滤噪音
- 4个字简洁易记
- 可作为产品简称和别名

**候选方案（已废弃）**:
- "AI 静音器" - 不够具体
- "智能守门员" - 稍长
- "静默阅读" - 不够体现核心功能

---

## 三、设计实现

### UI 布局

```
┌────────────────────────────┐
│ Feed AI Muter              │ ← 标题
│ AI 静音器                  │ ← 简称
├────────────────────────────┤
│                            │
│         🌱                 │ ← 大号成长图标（8xl，带动画）
│      (放大显示)             │
│                            │
│  欢迎使用智能 RSS 阅读器     │
│  正在学习你的兴趣...        │
│                            │
│  探索者阶段        0/1000页 │ ← 进度信息
│  ▓░░░░░░░░░░░░░░░░░░░░     │ ← 进度条
│                            │
│  📖 开始浏览，我会自动学习   │ ← 提示
│     你的兴趣                │
│                            │
├────────────────────────────┤
│         [设置]              │ ← 设置按钮
└────────────────────────────┘
```

### 成长阶段定义

| 页面数 | 阶段 | 图标 | 描述 |
|--------|------|------|------|
| 0-249 | 探索者 | 🌱 | 刚开始学习 |
| 250-599 | 学习者 | 🌿 | 开始理解兴趣 |
| 600-999 | 成长者 | 🌳 | 即将完成初始化 |
| 1000+ | 大师 | 🌲 | 开始智能推荐 |

### 主题支持

- ✅ 自动适配系统明暗主题
- ✅ 使用 Tailwind CSS 的 `dark:` 前缀
- ✅ 颜色对比度符合无障碍标准

---

## 四、技术实现

### 文件结构

```
src/
├── popup.tsx           # Popup 主组件（104 行）
├── popup.test.tsx      # 测试文件（21 个测试）
└── style.css           # 全局样式（已有）
```

### 关键代码

#### 1. 成长阶段判断函数

```typescript
export const getGrowthStage = (pageCount: number) => {
  if (pageCount < 250) return { icon: "🌱", name: "探索者" }
  if (pageCount < 600) return { icon: "🌿", name: "学习者" }
  if (pageCount < 1000) return { icon: "🌳", name: "成长者" }
  return { icon: "🌲", name: "大师" }
}
```

#### 2. 进度计算

```typescript
const progress = (pageCount / totalPages) * 100
```

#### 3. 设置按钮

```typescript
const openSettings = () => {
  chrome.runtime.openOptionsPage()
}
```

---

## 五、测试覆盖

### 测试统计

- **测试文件**: `src/popup.test.tsx`
- **测试用例数**: 21 个
- **覆盖率**: 
  - 语句覆盖率: 100%
  - 分支覆盖率: 100%
  - 函数覆盖率: 100%
  - 行覆盖率: 100%

### 测试用例

1. **getGrowthStage 函数测试** (4 个)
   - ✅ 0-249 页 → 探索者
   - ✅ 250-599 页 → 学习者
   - ✅ 600-999 页 → 成长者
   - ✅ 1000+ 页 → 大师

2. **组件渲染测试** (6 个)
   - ✅ 基本信息显示
   - ✅ 进度显示 0/1000
   - ✅ 探索者阶段显示
   - ✅ 提示信息显示
   - ✅ 设置按钮点击
   - ✅ 进度条宽度正确

### 运行测试

```bash
npm test                # 监听模式
npm run test:run        # 运行一次
npm run test:coverage   # 查看覆盖率
```

---

## 六、验收标准

### 功能验收

- [ ] 点击扩展图标后弹出界面
- [ ] 界面显示 "Feed AI Muter" 标题
- [ ] 显示 "AI 静音器" 简称
- [ ] 显示 🌱 图标（大号、居中、带动画）
- [ ] 显示 "0/1000 页" 文字
- [ ] 显示进度条（初始 0%）
- [ ] 界面自适应明暗主题
- [ ] 点击设置按钮跳转到设置页面
- [ ] 所有测试通过（21/21）
- [ ] 测试覆盖率 100%

### UI/UX 验收

- [ ] 弹窗尺寸合适（320px 宽）
- [ ] 图标够大够醒目（text-8xl）
- [ ] 进度条清晰可见
- [ ] 文字易读，对比度合适
- [ ] 深色模式下样式正常
- [ ] 动画流畅（图标脉动、进度条过渡）

---

## 七、已知问题

无

---

## 八、待优化项（V2）

1. 从 IndexedDB 读取真实的页面计数
2. 实时更新进度（当用户浏览时）
3. 添加页面访问历史查看
4. 添加主题切换按钮（可选）

---

## 九、截图对比

### 预期效果

见设计稿（DEVELOPMENT_PLAN.md）

### 实际效果

> 待浏览器测试后添加截图

---

## 十、下一步

完成浏览器测试后：
1. 根据反馈调整 UI
2. 开发设置页面（阶段 1.2）
3. 添加扩展图标（阶段 1.3）

---

**文档状态**: 开发完成，等待浏览器测试  
**测试命令**: `npm run test:coverage`  
**最后更新**: 2025-11-02 17:24

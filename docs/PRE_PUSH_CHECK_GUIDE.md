# æŽ¨é€å‰æ£€æŸ¥æŒ‡å—

## ä¸ºä»€ä¹ˆéœ€è¦æŽ¨é€å‰æ£€æŸ¥ï¼Ÿ

åœ¨æŽ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“å‰ï¼Œå¿…é¡»ç¡®ä¿ï¼š
1. âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
2. âœ… æµ‹è¯•è¦†ç›–çŽ‡è¾¾æ ‡
3. âœ… ç”Ÿäº§æž„å»ºæˆåŠŸ

è¿™æ ·å¯ä»¥ï¼š
- é¿å… CI å¤±è´¥ï¼Œæµªè´¹æ—¶é—´ç­‰å¾…ä¿®å¤
- ç¡®ä¿ä»£ç è´¨é‡
- æé«˜å›¢é˜Ÿåä½œæ•ˆçŽ‡

## ä½¿ç”¨æ–¹æ³•

### æ–¹å¼ 1: ä½¿ç”¨ npm è„šæœ¬ï¼ˆæŽ¨èï¼‰

```bash
npm run pre-push
```

### æ–¹å¼ 2: ç›´æŽ¥è¿è¡Œè„šæœ¬

```bash
bash scripts/pre-push-check.sh
```

## æ£€æŸ¥å†…å®¹

è„šæœ¬ä¼šä¾æ¬¡æ‰§è¡Œï¼š

### 1. æµ‹è¯•å¥—ä»¶
```bash
npm run test:run
```
- è¿è¡Œæ‰€æœ‰å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ç¡®ä¿æ²¡æœ‰æµ‹è¯•å¤±è´¥

### 2. æµ‹è¯•è¦†ç›–çŽ‡
```bash
npm run test:coverage
```
- æ£€æŸ¥ä»£ç è¦†ç›–çŽ‡æ˜¯å¦è¾¾æ ‡
- å½“å‰é˜ˆå€¼ï¼š
  - è¡Œè¦†ç›–çŽ‡ â‰¥ 70%
  - å‡½æ•°è¦†ç›–çŽ‡ â‰¥ 70%
  - åˆ†æ”¯è¦†ç›–çŽ‡ â‰¥ 58%ï¼ˆä¸´æ—¶ï¼‰
  - è¯­å¥è¦†ç›–çŽ‡ â‰¥ 70%

### 3. ç”Ÿäº§æž„å»º
```bash
npm run build
```
- ç¡®ä¿ä»£ç å¯ä»¥æˆåŠŸæž„å»º
- æ£€æµ‹æž„å»ºé”™è¯¯å’Œè­¦å‘Š

## è¾“å‡ºç¤ºä¾‹

æˆåŠŸæ—¶ï¼š
```
ðŸ” å¼€å§‹ Pre-push æ£€æŸ¥...

ðŸ“ è¿è¡Œæµ‹è¯•å¥—ä»¶...
âœ… æµ‹è¯•é€šè¿‡

ðŸ“Š æ£€æŸ¥æµ‹è¯•è¦†ç›–çŽ‡...
âœ… è¦†ç›–çŽ‡è¾¾æ ‡

ðŸ—ï¸  è¿è¡Œç”Ÿäº§æž„å»º...
âœ… æž„å»ºæˆåŠŸ

ðŸŽ‰ Pre-push æ£€æŸ¥å…¨éƒ¨é€šè¿‡ï¼
å¯ä»¥å®‰å…¨æŽ¨é€ä»£ç äº†ã€‚
```

å¤±è´¥æ—¶ï¼š
```
ðŸ” å¼€å§‹ Pre-push æ£€æŸ¥...

ðŸ“ è¿è¡Œæµ‹è¯•å¥—ä»¶...
âŒ æµ‹è¯•å¤±è´¥
```
è„šæœ¬ä¼šç«‹å³é€€å‡ºï¼Œä¸ä¼šç»§ç»­åŽç»­æ£€æŸ¥ã€‚

## å·¥ä½œæµç¨‹

### æ ‡å‡†æµç¨‹

```bash
# 1. å¼€å‘åŠŸèƒ½
git checkout -b feature/my-feature

# 2. ç¼–å†™ä»£ç å’Œæµ‹è¯•
# ...

# 3. æäº¤ä»£ç 
git add .
git commit -m "feat: å®žçŽ°æ–°åŠŸèƒ½"

# 4. æŽ¨é€å‰æ£€æŸ¥ âš ï¸ é‡è¦
npm run pre-push

# 5. æ£€æŸ¥é€šè¿‡åŽæŽ¨é€
git push origin feature/my-feature

# 6. åˆ›å»º PR
gh pr create --base master --head feature/my-feature
```

### å¦‚æžœæ£€æŸ¥å¤±è´¥

1. **æµ‹è¯•å¤±è´¥**
   ```bash
   # æŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
   npm test
   
   # ä¿®å¤åŽé‡æ–°è¿è¡Œ
   npm run test:run
   ```

2. **è¦†ç›–çŽ‡ä¸è¶³**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†è¦†ç›–çŽ‡æŠ¥å‘Š
   npm run test:coverage
   
   # æ‰“å¼€ HTML æŠ¥å‘Š
   open coverage/lcov-report/index.html
   
   # æ·»åŠ æµ‹è¯•ä»¥æé«˜è¦†ç›–çŽ‡
   ```

3. **æž„å»ºå¤±è´¥**
   ```bash
   # æŸ¥çœ‹æž„å»ºé”™è¯¯
   npm run build
   
   # ä¿®å¤ TypeScript é”™è¯¯æˆ–æž„å»ºé…ç½®
   ```

## è‡ªåŠ¨åŒ–ï¼ˆå¯é€‰ï¼‰

### Git Hooks

å¯ä»¥ä½¿ç”¨ Git hooks åœ¨æ¯æ¬¡æŽ¨é€å‰è‡ªåŠ¨è¿è¡Œæ£€æŸ¥ï¼š

```bash
# åˆ›å»º .git/hooks/pre-push æ–‡ä»¶
cat > .git/hooks/pre-push << 'EOF'
#!/bin/bash
exec bash scripts/pre-push-check.sh
EOF

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x .git/hooks/pre-push
```

è¿™æ ·æ¯æ¬¡ `git push` æ—¶ä¼šè‡ªåŠ¨è¿è¡Œæ£€æŸ¥ã€‚

**æ³¨æ„**ï¼šå¦‚æžœç¡®å®žéœ€è¦è·³è¿‡æ£€æŸ¥ï¼ˆä¸æŽ¨èï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
```bash
git push --no-verify
```

## å¸¸è§é—®é¢˜

### Q: æ£€æŸ¥å¤ªæ…¢æ€Žä¹ˆåŠžï¼Ÿ

A: å¯ä»¥å•ç‹¬è¿è¡ŒæŸäº›æ£€æŸ¥ï¼š
```bash
# åªè¿è¡Œæµ‹è¯•
npm run test:run

# åªæ£€æŸ¥è¦†ç›–çŽ‡
npm run test:coverage

# åªæž„å»º
npm run build
```

### Q: æˆ‘çš„æµ‹è¯•åœ¨æœ¬åœ°é€šè¿‡ï¼Œä½† CI å¤±è´¥ï¼Ÿ

A: å¯èƒ½çš„åŽŸå› ï¼š
1. çŽ¯å¢ƒå·®å¼‚ï¼ˆNode ç‰ˆæœ¬ã€ä¾èµ–ç‰ˆæœ¬ï¼‰
2. æœªæäº¤çš„æ–‡ä»¶
3. å¹¶å‘é—®é¢˜ï¼ˆæµ‹è¯•é—´ç›¸äº’å½±å“ï¼‰

è§£å†³æ–¹æ³•ï¼š
```bash
# ç¡®ä¿ä¾èµ–ä¸€è‡´
rm -rf node_modules package-lock.json
npm install

# é‡æ–°è¿è¡Œæµ‹è¯•
npm run test:run
```

### Q: è¦†ç›–çŽ‡åœ¨è¾¹ç•Œå€¼é™„è¿‘æ³¢åŠ¨ï¼Ÿ

A: è¿™æ˜¯æ­£å¸¸çš„ã€‚å¦‚æžœæŽ¥è¿‘é˜ˆå€¼ï¼š
1. æ£€æŸ¥æ˜¯å¦æœ‰æœªæµ‹è¯•çš„åˆ†æ”¯
2. æ·»åŠ é’ˆå¯¹æ€§æµ‹è¯•
3. ä½¿ç”¨ `open coverage/lcov-report/index.html` æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š

## æœ€ä½³å®žè·µ

1. **é¢‘ç¹æäº¤ï¼Œå°æ­¥æŽ¨é€**
   - æ¯ä¸ªåŠŸèƒ½ç‚¹å®ŒæˆåŽç«‹å³æäº¤
   - æŽ¨é€å‰è¿è¡Œæ£€æŸ¥

2. **æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDDï¼‰**
   - å…ˆå†™æµ‹è¯•ï¼Œå†å†™å®žçŽ°
   - ç¡®ä¿è¦†ç›–çŽ‡è‡ªç„¶è¾¾æ ‡

3. **ä¿æŒæ£€æŸ¥å¿«é€Ÿ**
   - é¿å…è¿‡é•¿çš„é›†æˆæµ‹è¯•
   - ä½¿ç”¨ mock å’Œ stub åŠ é€Ÿ

4. **CI å³æ—¶åé¦ˆ**
   - å³ä½¿æœ¬åœ°æ£€æŸ¥é€šè¿‡ï¼Œä¹Ÿå…³æ³¨ CI ç»“æžœ
   - CI çŽ¯å¢ƒå¯èƒ½æš´éœ²æœ¬åœ°æœªå‘çŽ°çš„é—®é¢˜

## ç›¸å…³æ–‡æ¡£

- [æµ‹è¯•æŒ‡å—](./TESTING.md)
- [å¼€å‘è®¡åˆ’](./DEVELOPMENT_PLAN.md)
- [Git å·¥ä½œæµ](../.github/copilot-instructions.md#version-control-workflow)

---

**è®°ä½**ï¼šæŽ¨é€å‰æ£€æŸ¥æ˜¯ä¿è¯ä»£ç è´¨é‡çš„æœ€åŽä¸€é“é˜²çº¿ï¼Œè¯·åŠ¡å¿…æ‰§è¡Œï¼ðŸ›¡ï¸
